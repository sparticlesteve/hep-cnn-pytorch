*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
0: 2018-09-27 22:32:17,288 INFO Initializing
0: 2018-09-27 22:32:17,326 INFO MPI rank 0
0: 2018-09-27 22:32:17,337 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
0: 2018-09-27 22:32:54,644 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
0: 2018-09-27 22:32:54,655 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-27 22:32:54,655 INFO Epoch 0
0: 2018-09-27 22:34:01,583 INFO   Training loss: 0.395
0: 2018-09-27 22:34:12,429 INFO   Validation loss: 0.313 acc: 0.904
0: 2018-09-27 22:34:12,438 INFO Epoch 1
0: 2018-09-27 22:35:21,306 INFO   Training loss: 0.295
0: 2018-09-27 22:35:37,213 INFO   Validation loss: 0.274 acc: 0.907
0: 2018-09-27 22:35:37,219 INFO Epoch 2
0: 2018-09-27 22:36:51,235 INFO   Training loss: 0.265
0: 2018-09-27 22:37:07,232 INFO   Validation loss: 0.243 acc: 0.913
0: 2018-09-27 22:37:07,239 INFO Epoch 3
0: 2018-09-27 22:38:21,775 INFO   Training loss: 0.170
0: 2018-09-27 22:38:37,893 INFO   Validation loss: 0.084 acc: 0.974
0: 2018-09-27 22:38:37,903 INFO Epoch 4
0: 2018-09-27 22:39:52,656 INFO   Training loss: 0.083
0: 2018-09-27 22:40:08,863 INFO   Validation loss: 0.049 acc: 0.984
0: 2018-09-27 22:40:08,873 INFO Epoch 5
0: 2018-09-27 22:41:23,547 INFO   Training loss: 0.077
0: 2018-09-27 22:41:39,673 INFO   Validation loss: 0.061 acc: 0.980
0: 2018-09-27 22:41:39,679 INFO Epoch 6
0: 2018-09-27 22:42:54,703 INFO   Training loss: 0.059
0: 2018-09-27 22:43:10,850 INFO   Validation loss: 0.040 acc: 0.987
0: 2018-09-27 22:43:10,864 INFO Epoch 7
0: 2018-09-27 22:44:24,504 INFO   Training loss: 0.051
0: 2018-09-27 22:44:40,796 INFO   Validation loss: 0.038 acc: 0.987
0: 2018-09-27 22:44:40,804 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-27 22:44:40,834 INFO Finished training
0: 2018-09-27 22:44:40,834 INFO Train samples 65536 time 72.8044s rate 900.166 samples/s
0: 2018-09-27 22:44:40,835 INFO Valid rate: 2120.27 samples/s
0: 2018-09-27 22:44:40,835 INFO All done!
