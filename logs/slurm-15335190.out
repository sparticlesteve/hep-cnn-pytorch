*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
 4: 2018-09-29 17:32:43,724 INFO Initializing
 8: 2018-09-29 17:32:43,724 INFO Initializing
 7: 2018-09-29 17:32:43,731 INFO Initializing
 9: 2018-09-29 17:32:43,734 INFO Initializing
 5: 2018-09-29 17:32:43,732 INFO Initializing
 2: 2018-09-29 17:32:43,744 INFO Initializing
 3: 2018-09-29 17:32:43,755 INFO Initializing
10: 2018-09-29 17:32:43,770 INFO Initializing
11: 2018-09-29 17:32:43,775 INFO Initializing
 6: 2018-09-29 17:32:43,777 INFO Initializing
15: 2018-09-29 17:32:43,789 INFO Initializing
 1: 2018-09-29 17:32:43,791 INFO Initializing
12: 2018-09-29 17:32:43,801 INFO Initializing
13: 2018-09-29 17:32:43,803 INFO Initializing
14: 2018-09-29 17:32:43,817 INFO Initializing
 0: 2018-09-29 17:32:44,226 INFO Initializing
14: 2018-09-29 17:32:44,273 INFO MPI rank 14
 1: 2018-09-29 17:32:44,272 INFO MPI rank 1
 3: 2018-09-29 17:32:44,274 INFO MPI rank 3
10: 2018-09-29 17:32:44,272 INFO MPI rank 10
 2: 2018-09-29 17:32:44,276 INFO MPI rank 2
 6: 2018-09-29 17:32:44,273 INFO MPI rank 6
 4: 2018-09-29 17:32:44,280 INFO MPI rank 4
 8: 2018-09-29 17:32:44,276 INFO MPI rank 8
12: 2018-09-29 17:32:44,274 INFO MPI rank 12
15: 2018-09-29 17:32:44,272 INFO MPI rank 15
13: 2018-09-29 17:32:44,271 INFO MPI rank 13
 9: 2018-09-29 17:32:44,277 INFO MPI rank 9
 7: 2018-09-29 17:32:44,274 INFO MPI rank 7
11: 2018-09-29 17:32:44,272 INFO MPI rank 11
 5: 2018-09-29 17:32:44,274 INFO MPI rank 5
 0: 2018-09-29 17:32:44,273 INFO MPI rank 0
 0: 2018-09-29 17:32:44,280 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 409600, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 2}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
10: 2018-09-29 17:37:04,492 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 8: 2018-09-29 17:37:04,499 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
14: 2018-09-29 17:37:04,504 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
11: 2018-09-29 17:37:04,588 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 6: 2018-09-29 17:37:04,648 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
13: 2018-09-29 17:37:04,655 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
15: 2018-09-29 17:37:04,679 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 0: 2018-09-29 17:37:04,876 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
12: 2018-09-29 17:37:05,292 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 2: 2018-09-29 17:37:05,316 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 1: 2018-09-29 17:37:05,870 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 9: 2018-09-29 17:37:06,532 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 7: 2018-09-29 17:37:06,788 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 4: 2018-09-29 17:37:06,804 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 5: 2018-09-29 17:37:07,087 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 3: 2018-09-29 17:37:08,632 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 7: 2018-09-29 17:37:08,679 INFO Epoch 0
 5: 2018-09-29 17:37:08,679 INFO Epoch 0
 0: 2018-09-29 17:37:08,678 INFO Model: 
 0: HEPCNNClassifier(
 0:   (conv_net): Sequential(
 0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (1): ReLU()
 0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (4): ReLU()
 0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (7): ReLU()
 0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:   )
 0:   (dense_net): Sequential(
 0:     (0): Linear(in_features=4096, out_features=128, bias=True)
 0:     (1): ReLU()
 0:     (2): Dropout(p=0.2)
 0:     (3): Linear(in_features=128, out_features=1, bias=True)
 0:     (4): Sigmoid()
 0:   )
 0: )
 0: Parameters: 547841
 8: 2018-09-29 17:37:08,683 INFO Epoch 0
 1: 2018-09-29 17:37:08,678 INFO Epoch 0
 0: 2018-09-29 17:37:08,678 INFO Epoch 0
10: 2018-09-29 17:37:08,679 INFO Epoch 0
 6: 2018-09-29 17:37:08,679 INFO Epoch 0
 9: 2018-09-29 17:37:08,684 INFO Epoch 0
11: 2018-09-29 17:37:08,679 INFO Epoch 0
 4: 2018-09-29 17:37:08,686 INFO Epoch 0
 2: 2018-09-29 17:37:08,688 INFO Epoch 0
 3: 2018-09-29 17:37:08,686 INFO Epoch 0
12: 2018-09-29 17:37:08,688 INFO Epoch 0
14: 2018-09-29 17:37:08,687 INFO Epoch 0
13: 2018-09-29 17:37:08,684 INFO Epoch 0
15: 2018-09-29 17:37:08,686 INFO Epoch 0
15: 2018-09-29 17:37:54,266 INFO   Training loss: 0.701
 8: 2018-09-29 17:37:54,270 INFO   Training loss: 0.697
 0: 2018-09-29 17:37:54,267 INFO   Training loss: 0.701
 6: 2018-09-29 17:37:54,267 INFO   Training loss: 0.697
 9: 2018-09-29 17:37:54,271 INFO   Training loss: 0.701
 5: 2018-09-29 17:37:54,268 INFO   Training loss: 0.701
10: 2018-09-29 17:37:54,266 INFO   Training loss: 0.698
13: 2018-09-29 17:37:54,265 INFO   Training loss: 0.698
 7: 2018-09-29 17:37:54,269 INFO   Training loss: 0.699
 1: 2018-09-29 17:37:54,267 INFO   Training loss: 0.699
 3: 2018-09-29 17:37:54,269 INFO   Training loss: 0.699
12: 2018-09-29 17:37:54,269 INFO   Training loss: 0.697
 2: 2018-09-29 17:37:54,271 INFO   Training loss: 0.700
14: 2018-09-29 17:37:54,269 INFO   Training loss: 0.697
 4: 2018-09-29 17:37:54,275 INFO   Training loss: 0.697
11: 2018-09-29 17:37:54,267 INFO   Training loss: 0.701
 9: 2018-09-29 17:38:18,058 INFO   Validation loss: 0.682 acc: 0.574
 9: 2018-09-29 17:38:18,074 INFO Epoch 1
13: 2018-09-29 17:38:18,139 INFO   Validation loss: 0.682 acc: 0.574
13: 2018-09-29 17:38:18,222 INFO Epoch 1
10: 2018-09-29 17:38:18,259 INFO   Validation loss: 0.682 acc: 0.574
 1: 2018-09-29 17:38:18,268 INFO   Validation loss: 0.682 acc: 0.574
14: 2018-09-29 17:38:18,284 INFO   Validation loss: 0.682 acc: 0.574
 3: 2018-09-29 17:38:18,307 INFO   Validation loss: 0.682 acc: 0.574
 7: 2018-09-29 17:38:18,373 INFO   Validation loss: 0.682 acc: 0.574
11: 2018-09-29 17:38:18,407 INFO   Validation loss: 0.682 acc: 0.574
 0: 2018-09-29 17:38:18,472 INFO   Validation loss: 0.682 acc: 0.574
 6: 2018-09-29 17:38:18,573 INFO   Validation loss: 0.682 acc: 0.574
 5: 2018-09-29 17:38:18,682 INFO   Validation loss: 0.682 acc: 0.574
15: 2018-09-29 17:38:18,816 INFO   Validation loss: 0.682 acc: 0.574
 8: 2018-09-29 17:38:19,009 INFO   Validation loss: 0.682 acc: 0.574
15: 2018-09-29 17:38:20,358 INFO Epoch 1
 1: 2018-09-29 17:38:20,809 INFO Epoch 1
 0: 2018-09-29 17:38:21,125 INFO Epoch 1
14: 2018-09-29 17:38:21,381 INFO Epoch 1
10: 2018-09-29 17:38:21,490 INFO Epoch 1
 3: 2018-09-29 17:38:21,608 INFO Epoch 1
11: 2018-09-29 17:38:21,640 INFO Epoch 1
 7: 2018-09-29 17:38:21,700 INFO Epoch 1
 6: 2018-09-29 17:38:21,911 INFO Epoch 1
 5: 2018-09-29 17:38:21,938 INFO Epoch 1
 8: 2018-09-29 17:38:21,971 INFO Epoch 1
 2: 2018-09-29 17:38:27,006 INFO   Validation loss: 0.682 acc: 0.574
 2: 2018-09-29 17:38:27,026 INFO Epoch 1
12: 2018-09-29 17:38:27,066 INFO   Validation loss: 0.682 acc: 0.574
12: 2018-09-29 17:38:27,138 INFO Epoch 1
 4: 2018-09-29 17:38:27,194 INFO   Validation loss: 0.682 acc: 0.574
 4: 2018-09-29 17:38:27,283 INFO Epoch 1
 1: 2018-09-29 17:39:12,811 INFO   Training loss: 0.684
 9: 2018-09-29 17:39:12,816 INFO   Training loss: 0.681
12: 2018-09-29 17:39:12,813 INFO   Training loss: 0.683
 5: 2018-09-29 17:39:12,813 INFO   Training loss: 0.683
13: 2018-09-29 17:39:12,810 INFO   Training loss: 0.681
11: 2018-09-29 17:39:12,811 INFO   Training loss: 0.681
 4: 2018-09-29 17:39:12,820 INFO   Training loss: 0.682
15: 2018-09-29 17:39:12,811 INFO   Training loss: 0.683
 3: 2018-09-29 17:39:12,813 INFO   Training loss: 0.684
 7: 2018-09-29 17:39:12,814 INFO   Training loss: 0.682
14: 2018-09-29 17:39:12,814 INFO   Training loss: 0.682
 8: 2018-09-29 17:39:12,816 INFO   Training loss: 0.681
 2: 2018-09-29 17:39:12,817 INFO   Training loss: 0.683
 0: 2018-09-29 17:39:12,813 INFO   Training loss: 0.682
10: 2018-09-29 17:39:12,812 INFO   Training loss: 0.682
 6: 2018-09-29 17:39:12,813 INFO   Training loss: 0.682
14: 2018-09-29 17:39:36,734 INFO   Validation loss: 0.682 acc: 0.574
14: 2018-09-29 17:39:36,763 INFO Finished training
14: 2018-09-29 17:39:36,764 INFO Train samples 25600 time 48.507s rate 527.758 samples/s
14: 2018-09-29 17:39:36,764 INFO Valid rate: 1367.21 samples/s
14: 2018-09-29 17:39:36,764 INFO All done!
 3: 2018-09-29 17:39:36,771 INFO   Validation loss: 0.682 acc: 0.574
 9: 2018-09-29 17:39:36,789 INFO   Validation loss: 0.682 acc: 0.574
 7: 2018-09-29 17:39:36,833 INFO   Validation loss: 0.682 acc: 0.574
 1: 2018-09-29 17:39:36,864 INFO   Validation loss: 0.682 acc: 0.574
11: 2018-09-29 17:39:36,867 INFO   Validation loss: 0.682 acc: 0.574
 6: 2018-09-29 17:39:37,073 INFO   Validation loss: 0.682 acc: 0.574
 0: 2018-09-29 17:39:37,152 INFO   Validation loss: 0.682 acc: 0.574
 3: 2018-09-29 17:39:37,350 INFO Finished training
 3: 2018-09-29 17:39:37,350 INFO Train samples 25600 time 48.3936s rate 528.995 samples/s
 3: 2018-09-29 17:39:37,350 INFO Valid rate: 1365.45 samples/s
 3: 2018-09-29 17:39:37,350 INFO All done!
 5: 2018-09-29 17:39:37,398 INFO   Validation loss: 0.682 acc: 0.574
10: 2018-09-29 17:39:37,503 INFO   Validation loss: 0.682 acc: 0.574
 8: 2018-09-29 17:39:37,693 INFO   Validation loss: 0.682 acc: 0.574
 0: 2018-09-29 17:39:38,386 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
 0: 2018-09-29 17:39:38,407 INFO Finished training
 0: 2018-09-29 17:39:38,407 INFO Train samples 25600 time 48.6382s rate 526.335 samples/s
 0: 2018-09-29 17:39:38,407 INFO Valid rate: 1350.04 samples/s
 0: 2018-09-29 17:39:38,407 INFO All done!
11: 2018-09-29 17:39:38,617 INFO Finished training
11: 2018-09-29 17:39:38,618 INFO Train samples 25600 time 48.3799s rate 529.146 samples/s
11: 2018-09-29 17:39:38,618 INFO Valid rate: 1359.83 samples/s
11: 2018-09-29 17:39:38,618 INFO All done!
 9: 2018-09-29 17:39:38,643 INFO Finished training
 9: 2018-09-29 17:39:38,643 INFO Train samples 25600 time 50.1642s rate 510.324 samples/s
 9: 2018-09-29 17:39:38,643 INFO Valid rate: 1372.28 samples/s
 9: 2018-09-29 17:39:38,643 INFO All done!
10: 2018-09-29 17:39:38,760 INFO Finished training
10: 2018-09-29 17:39:38,760 INFO Train samples 25600 time 48.4549s rate 528.327 samples/s
10: 2018-09-29 17:39:38,760 INFO Valid rate: 1346.22 samples/s
10: 2018-09-29 17:39:38,760 INFO All done!
 7: 2018-09-29 17:39:39,449 INFO Finished training
 7: 2018-09-29 17:39:39,449 INFO Train samples 25600 time 48.3517s rate 529.454 samples/s
 7: 2018-09-29 17:39:39,449 INFO Valid rate: 1361.85 samples/s
 7: 2018-09-29 17:39:39,449 INFO All done!
 1: 2018-09-29 17:39:39,554 INFO Finished training
 1: 2018-09-29 17:39:39,554 INFO Train samples 25600 time 48.7955s rate 524.639 samples/s
 1: 2018-09-29 17:39:39,554 INFO Valid rate: 1363.82 samples/s
 1: 2018-09-29 17:39:39,554 INFO All done!
 6: 2018-09-29 17:39:39,617 INFO Finished training
 6: 2018-09-29 17:39:39,617 INFO Train samples 25600 time 48.2449s rate 530.626 samples/s
 6: 2018-09-29 17:39:39,617 INFO Valid rate: 1349.45 samples/s
 6: 2018-09-29 17:39:39,617 INFO All done!
 5: 2018-09-29 17:39:39,749 INFO Finished training
 5: 2018-09-29 17:39:39,749 INFO Train samples 25600 time 48.2318s rate 530.771 samples/s
 5: 2018-09-29 17:39:39,749 INFO Valid rate: 1337.5 samples/s
 5: 2018-09-29 17:39:39,749 INFO All done!
 8: 2018-09-29 17:39:39,786 INFO Finished training
 8: 2018-09-29 17:39:39,787 INFO Train samples 25600 time 48.2159s rate 530.945 samples/s
 8: 2018-09-29 17:39:39,787 INFO Valid rate: 1320.89 samples/s
 8: 2018-09-29 17:39:39,787 INFO All done!
15: 2018-09-29 17:39:41,887 INFO   Validation loss: 0.682 acc: 0.574
15: 2018-09-29 17:39:41,930 INFO Finished training
15: 2018-09-29 17:39:41,930 INFO Train samples 25600 time 49.0167s rate 522.271 samples/s
15: 2018-09-29 17:39:41,930 INFO Valid rate: 1222.11 samples/s
15: 2018-09-29 17:39:41,930 INFO All done!
 2: 2018-09-29 17:39:41,958 INFO   Validation loss: 0.682 acc: 0.574
13: 2018-09-29 17:39:42,014 INFO   Validation loss: 0.682 acc: 0.574
12: 2018-09-29 17:39:42,020 INFO   Validation loss: 0.682 acc: 0.574
 4: 2018-09-29 17:39:42,031 INFO   Validation loss: 0.682 acc: 0.574
13: 2018-09-29 17:39:42,352 INFO Finished training
13: 2018-09-29 17:39:42,353 INFO Train samples 25600 time 50.0839s rate 511.142 samples/s
13: 2018-09-29 17:39:42,353 INFO Valid rate: 1234.77 samples/s
13: 2018-09-29 17:39:42,353 INFO All done!
12: 2018-09-29 17:39:42,831 INFO Finished training
12: 2018-09-29 17:39:42,831 INFO Train samples 25600 time 45.6284s rate 561.054 samples/s
12: 2018-09-29 17:39:42,832 INFO Valid rate: 1056.97 samples/s
12: 2018-09-29 17:39:42,832 INFO All done!
 2: 2018-09-29 17:39:43,206 INFO Finished training
 2: 2018-09-29 17:39:43,206 INFO Train samples 25600 time 45.6869s rate 560.336 samples/s
 2: 2018-09-29 17:39:43,207 INFO Valid rate: 1059.15 samples/s
 2: 2018-09-29 17:39:43,207 INFO All done!
 4: 2018-09-29 17:39:43,239 INFO Finished training
 4: 2018-09-29 17:39:43,239 INFO Train samples 25600 time 45.5625s rate 561.865 samples/s
 4: 2018-09-29 17:39:43,239 INFO Valid rate: 1054.87 samples/s
 4: 2018-09-29 17:39:43,239 INFO All done!
