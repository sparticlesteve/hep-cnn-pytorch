*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
0: 2018-09-27 23:01:57,807 INFO Initializing
3: 2018-09-27 23:01:57,814 INFO Initializing
2: 2018-09-27 23:01:58,039 INFO Initializing
1: 2018-09-27 23:01:58,545 INFO Initializing
3: 2018-09-27 23:01:58,593 INFO MPI rank 3
0: 2018-09-27 23:01:58,592 INFO MPI rank 0
1: 2018-09-27 23:01:58,591 INFO MPI rank 1
2: 2018-09-27 23:01:58,593 INFO MPI rank 2
0: 2018-09-27 23:01:58,598 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
0: 2018-09-27 23:02:48,655 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
2: 2018-09-27 23:02:48,678 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-27 23:02:48,719 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
3: 2018-09-27 23:02:48,730 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
3: 2018-09-27 23:02:48,766 INFO Epoch 0
2: 2018-09-27 23:02:48,766 INFO Epoch 0
1: 2018-09-27 23:02:48,765 INFO Epoch 0
0: 2018-09-27 23:02:48,765 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-27 23:02:48,765 INFO Epoch 0
3: 2018-09-27 23:03:14,414 INFO   Training loss: 0.419
1: 2018-09-27 23:03:14,413 INFO   Training loss: 0.419
2: 2018-09-27 23:03:14,416 INFO   Training loss: 0.419
0: 2018-09-27 23:03:14,416 INFO   Training loss: 0.413
2: 2018-09-27 23:03:33,703 INFO   Validation loss: 0.235 acc: 0.905
2: 2018-09-27 23:03:33,723 INFO Epoch 1
1: 2018-09-27 23:03:34,225 INFO   Validation loss: 0.235 acc: 0.905
1: 2018-09-27 23:03:34,344 INFO Epoch 1
0: 2018-09-27 23:03:34,486 INFO   Validation loss: 0.235 acc: 0.905
0: 2018-09-27 23:03:34,585 INFO Epoch 1
3: 2018-09-27 23:03:38,959 INFO   Validation loss: 0.235 acc: 0.905
3: 2018-09-27 23:03:39,080 INFO Epoch 1
2: 2018-09-27 23:04:05,045 INFO   Training loss: 0.243
1: 2018-09-27 23:04:05,045 INFO   Training loss: 0.244
0: 2018-09-27 23:04:05,045 INFO   Training loss: 0.244
3: 2018-09-27 23:04:05,049 INFO   Training loss: 0.243
1: 2018-09-27 23:04:24,992 INFO   Validation loss: 0.230 acc: 0.906
1: 2018-09-27 23:04:25,012 INFO Epoch 2
2: 2018-09-27 23:04:25,435 INFO   Validation loss: 0.230 acc: 0.906
2: 2018-09-27 23:04:25,517 INFO Epoch 2
0: 2018-09-27 23:04:31,525 INFO   Validation loss: 0.230 acc: 0.906
0: 2018-09-27 23:04:31,543 INFO Epoch 2
3: 2018-09-27 23:04:31,578 INFO   Validation loss: 0.230 acc: 0.906
3: 2018-09-27 23:04:31,653 INFO Epoch 2
0: 2018-09-27 23:04:57,007 INFO   Training loss: 0.239
2: 2018-09-27 23:04:57,008 INFO   Training loss: 0.241
3: 2018-09-27 23:04:57,012 INFO   Training loss: 0.240
1: 2018-09-27 23:04:57,025 INFO   Training loss: 0.242
1: 2018-09-27 23:05:17,102 INFO   Validation loss: 0.229 acc: 0.907
1: 2018-09-27 23:05:17,124 INFO Epoch 3
2: 2018-09-27 23:05:17,449 INFO   Validation loss: 0.229 acc: 0.907
3: 2018-09-27 23:05:17,485 INFO   Validation loss: 0.229 acc: 0.907
2: 2018-09-27 23:05:17,541 INFO Epoch 3
3: 2018-09-27 23:05:17,600 INFO Epoch 3
0: 2018-09-27 23:05:22,736 INFO   Validation loss: 0.229 acc: 0.907
0: 2018-09-27 23:05:22,750 INFO Epoch 3
0: 2018-09-27 23:05:47,578 INFO   Training loss: 0.235
3: 2018-09-27 23:05:47,580 INFO   Training loss: 0.236
2: 2018-09-27 23:05:47,580 INFO   Training loss: 0.236
1: 2018-09-27 23:05:47,582 INFO   Training loss: 0.236
0: 2018-09-27 23:06:03,103 INFO   Validation loss: 0.227 acc: 0.908
0: 2018-09-27 23:06:03,111 INFO Epoch 4
2: 2018-09-27 23:06:05,686 INFO   Validation loss: 0.227 acc: 0.908
2: 2018-09-27 23:06:05,773 INFO Epoch 4
3: 2018-09-27 23:06:06,174 INFO   Validation loss: 0.227 acc: 0.908
3: 2018-09-27 23:06:06,283 INFO Epoch 4
1: 2018-09-27 23:06:06,562 INFO   Validation loss: 0.227 acc: 0.908
1: 2018-09-27 23:06:06,611 INFO Epoch 4
1: 2018-09-27 23:06:31,587 INFO   Training loss: 0.228
3: 2018-09-27 23:06:31,589 INFO   Training loss: 0.229
2: 2018-09-27 23:06:31,589 INFO   Training loss: 0.228
0: 2018-09-27 23:06:31,590 INFO   Training loss: 0.229
2: 2018-09-27 23:06:48,843 INFO   Validation loss: 0.226 acc: 0.908
2: 2018-09-27 23:06:48,850 INFO Epoch 5
0: 2018-09-27 23:06:48,912 INFO   Validation loss: 0.226 acc: 0.908
0: 2018-09-27 23:06:49,016 INFO Epoch 5
1: 2018-09-27 23:06:50,051 INFO   Validation loss: 0.226 acc: 0.908
1: 2018-09-27 23:06:50,162 INFO Epoch 5
3: 2018-09-27 23:06:50,399 INFO   Validation loss: 0.226 acc: 0.908
3: 2018-09-27 23:06:50,482 INFO Epoch 5
0: 2018-09-27 23:07:15,807 INFO   Training loss: 0.209
1: 2018-09-27 23:07:15,816 INFO   Training loss: 0.207
2: 2018-09-27 23:07:15,817 INFO   Training loss: 0.206
3: 2018-09-27 23:07:15,821 INFO   Training loss: 0.209
2: 2018-09-27 23:07:30,465 INFO   Validation loss: 0.172 acc: 0.933
2: 2018-09-27 23:07:30,473 INFO Epoch 6
3: 2018-09-27 23:07:31,701 INFO   Validation loss: 0.172 acc: 0.933
3: 2018-09-27 23:07:31,753 INFO Epoch 6
0: 2018-09-27 23:07:32,585 INFO   Validation loss: 0.172 acc: 0.933
0: 2018-09-27 23:07:32,665 INFO Epoch 6
1: 2018-09-27 23:07:34,123 INFO   Validation loss: 0.172 acc: 0.933
1: 2018-09-27 23:07:34,243 INFO Epoch 6
3: 2018-09-27 23:07:59,649 INFO   Training loss: 0.193
2: 2018-09-27 23:07:59,648 INFO   Training loss: 0.187
0: 2018-09-27 23:07:59,648 INFO   Training loss: 0.190
1: 2018-09-27 23:07:59,664 INFO   Training loss: 0.192
2: 2018-09-27 23:08:16,409 INFO   Validation loss: 0.229 acc: 0.907
2: 2018-09-27 23:08:16,425 INFO Epoch 7
1: 2018-09-27 23:08:17,363 INFO   Validation loss: 0.229 acc: 0.907
3: 2018-09-27 23:08:17,381 INFO   Validation loss: 0.229 acc: 0.907
0: 2018-09-27 23:08:17,920 INFO   Validation loss: 0.229 acc: 0.907
0: 2018-09-27 23:08:18,587 INFO Epoch 7
1: 2018-09-27 23:08:18,652 INFO Epoch 7
3: 2018-09-27 23:08:18,712 INFO Epoch 7
0: 2018-09-27 23:08:43,924 INFO   Training loss: 0.226
3: 2018-09-27 23:08:43,929 INFO   Training loss: 0.225
1: 2018-09-27 23:08:43,931 INFO   Training loss: 0.227
2: 2018-09-27 23:08:43,934 INFO   Training loss: 0.227
3: 2018-09-27 23:09:03,709 INFO   Validation loss: 0.191 acc: 0.922
3: 2018-09-27 23:09:03,725 INFO Finished training
3: 2018-09-27 23:09:03,725 INFO Train samples 16384 time 26.339s rate 622.043 samples/s
3: 2018-09-27 23:09:03,725 INFO Valid rate: 1614.79 samples/s
3: 2018-09-27 23:09:03,725 INFO All done!
1: 2018-09-27 23:09:04,140 INFO   Validation loss: 0.191 acc: 0.922
2: 2018-09-27 23:09:04,181 INFO   Validation loss: 0.191 acc: 0.922
0: 2018-09-27 23:09:04,436 INFO   Validation loss: 0.191 acc: 0.922
2: 2018-09-27 23:09:04,483 INFO Finished training
2: 2018-09-27 23:09:04,483 INFO Train samples 16384 time 28.4961s rate 574.956 samples/s
2: 2018-09-27 23:09:04,483 INFO Valid rate: 1781.74 samples/s
2: 2018-09-27 23:09:04,483 INFO All done!
1: 2018-09-27 23:09:04,618 INFO Finished training
1: 2018-09-27 23:09:04,619 INFO Train samples 16384 time 27.5186s rate 595.379 samples/s
1: 2018-09-27 23:09:04,619 INFO Valid rate: 1707.98 samples/s
1: 2018-09-27 23:09:04,619 INFO All done!
0: 2018-09-27 23:09:04,694 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-27 23:09:04,719 INFO Finished training
0: 2018-09-27 23:09:04,719 INFO Train samples 16384 time 26.7489s rate 612.512 samples/s
0: 2018-09-27 23:09:04,719 INFO Valid rate: 1631.41 samples/s
0: 2018-09-27 23:09:04,719 INFO All done!
