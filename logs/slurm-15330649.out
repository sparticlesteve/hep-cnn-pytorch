*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
11: 2018-09-29 14:00:22,541 INFO Initializing
10: 2018-09-29 14:00:22,586 INFO Initializing
13: 2018-09-29 14:00:22,610 INFO Initializing
14: 2018-09-29 14:00:22,615 INFO Initializing
 5: 2018-09-29 14:00:22,721 INFO Initializing
 7: 2018-09-29 14:00:22,835 INFO Initializing
 8: 2018-09-29 14:00:22,854 INFO Initializing
 0: 2018-09-29 14:00:22,875 INFO Initializing
 2: 2018-09-29 14:00:22,873 INFO Initializing
 9: 2018-09-29 14:00:22,891 INFO Initializing
12: 2018-09-29 14:00:22,895 INFO Initializing
 3: 2018-09-29 14:00:22,913 INFO Initializing
 4: 2018-09-29 14:00:22,969 INFO Initializing
 6: 2018-09-29 14:00:22,991 INFO Initializing
15: 2018-09-29 14:00:23,000 INFO Initializing
 1: 2018-09-29 14:00:23,030 INFO Initializing
 5: 2018-09-29 14:00:23,078 INFO MPI rank 5
 4: 2018-09-29 14:00:23,075 INFO MPI rank 4
 2: 2018-09-29 14:00:23,075 INFO MPI rank 2
12: 2018-09-29 14:00:23,075 INFO MPI rank 12
13: 2018-09-29 14:00:23,077 INFO MPI rank 13
15: 2018-09-29 14:00:23,076 INFO MPI rank 15
 1: 2018-09-29 14:00:23,077 INFO MPI rank 1
 3: 2018-09-29 14:00:23,075 INFO MPI rank 3
 9: 2018-09-29 14:00:23,077 INFO MPI rank 9
 8: 2018-09-29 14:00:23,078 INFO MPI rank 8
 7: 2018-09-29 14:00:23,078 INFO MPI rank 7
11: 2018-09-29 14:00:23,076 INFO MPI rank 11
 6: 2018-09-29 14:00:23,078 INFO MPI rank 6
10: 2018-09-29 14:00:23,078 INFO MPI rank 10
 0: 2018-09-29 14:00:23,080 INFO MPI rank 0
14: 2018-09-29 14:00:23,078 INFO MPI rank 14
 0: 2018-09-29 14:00:23,084 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 409600, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 2}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
 3: 2018-09-29 14:02:57,614 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 7: 2018-09-29 14:02:57,617 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 6: 2018-09-29 14:02:57,618 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 2: 2018-09-29 14:02:57,615 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
13: 2018-09-29 14:02:57,617 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
10: 2018-09-29 14:02:57,618 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 0: 2018-09-29 14:02:57,620 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
11: 2018-09-29 14:02:57,619 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
12: 2018-09-29 14:02:57,626 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 9: 2018-09-29 14:02:57,654 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 8: 2018-09-29 14:02:57,691 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 4: 2018-09-29 14:02:57,742 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
14: 2018-09-29 14:02:57,812 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 5: 2018-09-29 14:02:57,915 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 1: 2018-09-29 14:02:57,953 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
15: 2018-09-29 14:02:58,066 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
 4: 2018-09-29 14:02:58,073 INFO Epoch 0
 5: 2018-09-29 14:02:58,075 INFO Epoch 0
 1: 2018-09-29 14:02:58,074 INFO Epoch 0
 3: 2018-09-29 14:02:58,073 INFO Epoch 0
 0: 2018-09-29 14:02:58,077 INFO Model: 
 0: HEPCNNClassifier(
 0:   (conv_net): Sequential(
 0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (1): ReLU()
 0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (4): ReLU()
 0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
 0:     (7): ReLU()
 0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
 0:   )
 0:   (dense_net): Sequential(
 0:     (0): Linear(in_features=4096, out_features=128, bias=True)
 0:     (1): ReLU()
 0:     (2): Dropout(p=0.2)
 0:     (3): Linear(in_features=128, out_features=1, bias=True)
 0:     (4): Sigmoid()
 0:   )
 0: )
 0: Parameters: 547841
 2: 2018-09-29 14:02:58,073 INFO Epoch 0
 6: 2018-09-29 14:02:58,076 INFO Epoch 0
 7: 2018-09-29 14:02:58,075 INFO Epoch 0
 0: 2018-09-29 14:02:58,078 INFO Epoch 0
10: 2018-09-29 14:02:58,083 INFO Epoch 0
 9: 2018-09-29 14:02:58,082 INFO Epoch 0
 8: 2018-09-29 14:02:58,084 INFO Epoch 0
11: 2018-09-29 14:02:58,081 INFO Epoch 0
12: 2018-09-29 14:02:58,087 INFO Epoch 0
13: 2018-09-29 14:02:58,089 INFO Epoch 0
14: 2018-09-29 14:02:58,090 INFO Epoch 0
15: 2018-09-29 14:02:58,087 INFO Epoch 0
 2: 2018-09-29 14:03:29,647 INFO   Training loss: 0.407
13: 2018-09-29 14:03:29,649 INFO   Training loss: 0.412
 1: 2018-09-29 14:03:29,648 INFO   Training loss: 0.408
 8: 2018-09-29 14:03:29,650 INFO   Training loss: 0.405
 0: 2018-09-29 14:03:29,651 INFO   Training loss: 0.416
 6: 2018-09-29 14:03:29,650 INFO   Training loss: 0.397
14: 2018-09-29 14:03:29,650 INFO   Training loss: 0.406
15: 2018-09-29 14:03:29,647 INFO   Training loss: 0.416
10: 2018-09-29 14:03:29,650 INFO   Training loss: 0.405
 3: 2018-09-29 14:03:29,646 INFO   Training loss: 0.403
 7: 2018-09-29 14:03:29,649 INFO   Training loss: 0.405
 4: 2018-09-29 14:03:29,647 INFO   Training loss: 0.404
12: 2018-09-29 14:03:29,647 INFO   Training loss: 0.406
 5: 2018-09-29 14:03:29,649 INFO   Training loss: 0.408
 9: 2018-09-29 14:03:29,649 INFO   Training loss: 0.408
11: 2018-09-29 14:03:29,647 INFO   Training loss: 0.420
 2: 2018-09-29 14:03:40,203 INFO   Validation loss: 0.229 acc: 0.907
 2: 2018-09-29 14:03:40,210 INFO Epoch 1
 6: 2018-09-29 14:03:40,224 INFO   Validation loss: 0.229 acc: 0.907
 7: 2018-09-29 14:03:40,236 INFO   Validation loss: 0.229 acc: 0.907
11: 2018-09-29 14:03:40,235 INFO   Validation loss: 0.229 acc: 0.907
 4: 2018-09-29 14:03:40,235 INFO   Validation loss: 0.229 acc: 0.907
15: 2018-09-29 14:03:40,244 INFO   Validation loss: 0.229 acc: 0.907
 8: 2018-09-29 14:03:40,249 INFO   Validation loss: 0.229 acc: 0.907
 0: 2018-09-29 14:03:40,261 INFO   Validation loss: 0.229 acc: 0.907
13: 2018-09-29 14:03:40,280 INFO   Validation loss: 0.229 acc: 0.907
 5: 2018-09-29 14:03:40,306 INFO   Validation loss: 0.229 acc: 0.907
 9: 2018-09-29 14:03:40,306 INFO   Validation loss: 0.229 acc: 0.907
 1: 2018-09-29 14:03:40,319 INFO   Validation loss: 0.229 acc: 0.907
 0: 2018-09-29 14:03:42,007 INFO Epoch 1
 6: 2018-09-29 14:03:43,559 INFO Epoch 1
13: 2018-09-29 14:03:43,714 INFO Epoch 1
 4: 2018-09-29 14:03:44,008 INFO Epoch 1
11: 2018-09-29 14:03:44,530 INFO Epoch 1
 7: 2018-09-29 14:03:44,555 INFO Epoch 1
 8: 2018-09-29 14:03:44,580 INFO Epoch 1
15: 2018-09-29 14:03:44,624 INFO Epoch 1
 1: 2018-09-29 14:03:44,675 INFO Epoch 1
 9: 2018-09-29 14:03:44,718 INFO Epoch 1
 5: 2018-09-29 14:03:44,744 INFO Epoch 1
10: 2018-09-29 14:03:45,231 INFO   Validation loss: 0.229 acc: 0.907
10: 2018-09-29 14:03:45,264 INFO Epoch 1
12: 2018-09-29 14:03:45,304 INFO   Validation loss: 0.229 acc: 0.907
 3: 2018-09-29 14:03:45,321 INFO   Validation loss: 0.229 acc: 0.907
14: 2018-09-29 14:03:45,350 INFO   Validation loss: 0.229 acc: 0.907
12: 2018-09-29 14:03:46,179 INFO Epoch 1
 3: 2018-09-29 14:03:46,875 INFO Epoch 1
14: 2018-09-29 14:03:46,903 INFO Epoch 1
 2: 2018-09-29 14:04:17,604 INFO   Training loss: 0.228
12: 2018-09-29 14:04:17,604 INFO   Training loss: 0.235
13: 2018-09-29 14:04:17,606 INFO   Training loss: 0.238
10: 2018-09-29 14:04:17,607 INFO   Training loss: 0.232
 1: 2018-09-29 14:04:17,606 INFO   Training loss: 0.233
 9: 2018-09-29 14:04:17,606 INFO   Training loss: 0.230
 8: 2018-09-29 14:04:17,608 INFO   Training loss: 0.233
 7: 2018-09-29 14:04:17,607 INFO   Training loss: 0.229
 0: 2018-09-29 14:04:17,609 INFO   Training loss: 0.237
 4: 2018-09-29 14:04:17,604 INFO   Training loss: 0.233
 5: 2018-09-29 14:04:17,607 INFO   Training loss: 0.231
 6: 2018-09-29 14:04:17,607 INFO   Training loss: 0.232
14: 2018-09-29 14:04:17,607 INFO   Training loss: 0.233
15: 2018-09-29 14:04:17,605 INFO   Training loss: 0.231
11: 2018-09-29 14:04:17,605 INFO   Training loss: 0.235
 3: 2018-09-29 14:04:17,604 INFO   Training loss: 0.234
 6: 2018-09-29 14:04:28,249 INFO   Validation loss: 0.224 acc: 0.909
 2: 2018-09-29 14:04:28,247 INFO   Validation loss: 0.224 acc: 0.909
 7: 2018-09-29 14:04:28,273 INFO   Validation loss: 0.224 acc: 0.909
 4: 2018-09-29 14:04:28,278 INFO   Validation loss: 0.224 acc: 0.909
 8: 2018-09-29 14:04:28,282 INFO   Validation loss: 0.224 acc: 0.909
 1: 2018-09-29 14:04:28,348 INFO   Validation loss: 0.224 acc: 0.909
 2: 2018-09-29 14:04:28,433 INFO Finished training
 2: 2018-09-29 14:04:28,433 INFO Train samples 25600 time 34.4837s rate 742.38 samples/s
 2: 2018-09-29 14:04:28,433 INFO Valid rate: 3091.53 samples/s
 2: 2018-09-29 14:04:28,433 INFO All done!
 1: 2018-09-29 14:04:29,429 INFO Finished training
 1: 2018-09-29 14:04:29,429 INFO Train samples 25600 time 32.2524s rate 793.739 samples/s
 1: 2018-09-29 14:04:29,429 INFO Valid rate: 3060.58 samples/s
 1: 2018-09-29 14:04:29,429 INFO All done!
 7: 2018-09-29 14:04:29,962 INFO Finished training
 7: 2018-09-29 14:04:29,962 INFO Train samples 25600 time 32.3125s rate 792.263 samples/s
 7: 2018-09-29 14:04:29,962 INFO Valid rate: 3083.73 samples/s
 7: 2018-09-29 14:04:29,962 INFO All done!
 4: 2018-09-29 14:04:30,052 INFO Finished training
 4: 2018-09-29 14:04:30,053 INFO Train samples 25600 time 32.5852s rate 785.632 samples/s
 4: 2018-09-29 14:04:30,053 INFO Valid rate: 3082.55 samples/s
 4: 2018-09-29 14:04:30,053 INFO All done!
 6: 2018-09-29 14:04:30,123 INFO Finished training
 6: 2018-09-29 14:04:30,123 INFO Train samples 25600 time 32.811s rate 780.226 samples/s
 6: 2018-09-29 14:04:30,124 INFO Valid rate: 3089.09 samples/s
 6: 2018-09-29 14:04:30,124 INFO All done!
 8: 2018-09-29 14:04:30,168 INFO Finished training
 8: 2018-09-29 14:04:30,169 INFO Train samples 25600 time 32.2966s rate 792.653 samples/s
 8: 2018-09-29 14:04:30,169 INFO Valid rate: 3080.68 samples/s
 8: 2018-09-29 14:04:30,169 INFO All done!
13: 2018-09-29 14:04:33,223 INFO   Validation loss: 0.224 acc: 0.909
10: 2018-09-29 14:04:33,252 INFO   Validation loss: 0.224 acc: 0.909
 3: 2018-09-29 14:04:33,312 INFO   Validation loss: 0.224 acc: 0.909
 5: 2018-09-29 14:04:33,321 INFO   Validation loss: 0.224 acc: 0.909
11: 2018-09-29 14:04:33,339 INFO   Validation loss: 0.224 acc: 0.909
 9: 2018-09-29 14:04:33,349 INFO   Validation loss: 0.224 acc: 0.909
14: 2018-09-29 14:04:33,364 INFO   Validation loss: 0.224 acc: 0.909
15: 2018-09-29 14:04:33,364 INFO   Validation loss: 0.224 acc: 0.909
 0: 2018-09-29 14:04:33,369 INFO   Validation loss: 0.224 acc: 0.909
12: 2018-09-29 14:04:34,285 INFO   Validation loss: 0.224 acc: 0.909
10: 2018-09-29 14:04:35,862 INFO Finished training
10: 2018-09-29 14:04:35,862 INFO Train samples 25600 time 31.9543s rate 801.143 samples/s
10: 2018-09-29 14:04:35,862 INFO Valid rate: 2098.81 samples/s
10: 2018-09-29 14:04:35,862 INFO All done!
13: 2018-09-29 14:04:36,890 INFO Finished training
13: 2018-09-29 14:04:36,890 INFO Train samples 25600 time 32.7259s rate 782.255 samples/s
13: 2018-09-29 14:04:36,890 INFO Valid rate: 2496.92 samples/s
13: 2018-09-29 14:04:36,890 INFO All done!
 0: 2018-09-29 14:04:37,215 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
 0: 2018-09-29 14:04:37,230 INFO Finished training
 0: 2018-09-29 14:04:37,230 INFO Train samples 25600 time 33.5876s rate 762.185 samples/s
 0: 2018-09-29 14:04:37,230 INFO Valid rate: 2485.36 samples/s
 0: 2018-09-29 14:04:37,230 INFO All done!
11: 2018-09-29 14:04:37,310 INFO Finished training
11: 2018-09-29 14:04:37,311 INFO Train samples 25600 time 32.3203s rate 792.072 samples/s
11: 2018-09-29 14:04:37,311 INFO Valid rate: 2489.88 samples/s
11: 2018-09-29 14:04:37,311 INFO All done!
 5: 2018-09-29 14:04:37,330 INFO Finished training
 5: 2018-09-29 14:04:37,330 INFO Train samples 25600 time 32.2183s rate 794.579 samples/s
 5: 2018-09-29 14:04:37,330 INFO Valid rate: 2485.23 samples/s
 5: 2018-09-29 14:04:37,330 INFO All done!
 3: 2018-09-29 14:04:37,352 INFO Finished training
 3: 2018-09-29 14:04:37,352 INFO Train samples 25600 time 31.1515s rate 821.792 samples/s
 3: 2018-09-29 14:04:37,352 INFO Valid rate: 2088.32 samples/s
 3: 2018-09-29 14:04:37,352 INFO All done!
 9: 2018-09-29 14:04:37,372 INFO Finished training
 9: 2018-09-29 14:04:37,372 INFO Train samples 25600 time 32.2269s rate 794.368 samples/s
 9: 2018-09-29 14:04:37,372 INFO Valid rate: 2482.44 samples/s
 9: 2018-09-29 14:04:37,372 INFO All done!
15: 2018-09-29 14:04:37,411 INFO Finished training
15: 2018-09-29 14:04:37,411 INFO Train samples 25600 time 32.2705s rate 793.294 samples/s
15: 2018-09-29 14:04:37,411 INFO Valid rate: 2486.69 samples/s
15: 2018-09-29 14:04:37,411 INFO All done!
14: 2018-09-29 14:04:37,435 INFO Finished training
14: 2018-09-29 14:04:37,436 INFO Train samples 25600 time 31.1319s rate 822.309 samples/s
14: 2018-09-29 14:04:37,436 INFO Valid rate: 2083.47 samples/s
14: 2018-09-29 14:04:37,436 INFO All done!
12: 2018-09-29 14:04:37,455 INFO Finished training
12: 2018-09-29 14:04:37,455 INFO Train samples 25600 time 31.493s rate 812.88 samples/s
12: 2018-09-29 14:04:37,455 INFO Valid rate: 2026.72 samples/s
12: 2018-09-29 14:04:37,455 INFO All done!
