*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
7: 2018-09-27 23:12:27,560 INFO Initializing
0: 2018-09-27 23:12:28,353 INFO Initializing
5: 2018-09-27 23:12:28,592 INFO Initializing
1: 2018-09-27 23:12:28,627 INFO Initializing
3: 2018-09-27 23:12:28,934 INFO Initializing
4: 2018-09-27 23:12:29,109 INFO Initializing
6: 2018-09-27 23:12:29,357 INFO Initializing
2: 2018-09-27 23:12:29,486 INFO Initializing
2: 2018-09-27 23:12:29,535 INFO MPI rank 2
0: 2018-09-27 23:12:29,535 INFO MPI rank 0
1: 2018-09-27 23:12:29,534 INFO MPI rank 1
6: 2018-09-27 23:12:29,538 INFO MPI rank 6
7: 2018-09-27 23:12:29,536 INFO MPI rank 7
4: 2018-09-27 23:12:29,534 INFO MPI rank 4
3: 2018-09-27 23:12:29,535 INFO MPI rank 3
5: 2018-09-27 23:12:29,534 INFO MPI rank 5
0: 2018-09-27 23:12:29,544 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
4: 2018-09-27 23:13:24,904 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
6: 2018-09-27 23:13:24,949 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
7: 2018-09-27 23:13:25,015 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-27 23:13:25,069 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
5: 2018-09-27 23:13:25,149 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
2: 2018-09-27 23:13:25,164 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
0: 2018-09-27 23:13:25,182 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
3: 2018-09-27 23:13:25,281 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
2: 2018-09-27 23:13:25,321 INFO Epoch 0
1: 2018-09-27 23:13:25,319 INFO Epoch 0
3: 2018-09-27 23:13:25,320 INFO Epoch 0
0: 2018-09-27 23:13:25,321 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-27 23:13:25,321 INFO Epoch 0
7: 2018-09-27 23:13:25,328 INFO Epoch 0
5: 2018-09-27 23:13:25,326 INFO Epoch 0
6: 2018-09-27 23:13:25,329 INFO Epoch 0
4: 2018-09-27 23:13:25,325 INFO Epoch 0
6: 2018-09-27 23:13:38,851 INFO   Training loss: 0.522
7: 2018-09-27 23:13:38,850 INFO   Training loss: 0.519
4: 2018-09-27 23:13:38,847 INFO   Training loss: 0.519
3: 2018-09-27 23:13:38,848 INFO   Training loss: 0.522
0: 2018-09-27 23:13:38,850 INFO   Training loss: 0.517
5: 2018-09-27 23:13:38,848 INFO   Training loss: 0.524
2: 2018-09-27 23:13:38,850 INFO   Training loss: 0.523
1: 2018-09-27 23:13:38,849 INFO   Training loss: 0.520
7: 2018-09-27 23:14:02,250 INFO   Validation loss: 0.267 acc: 0.895
5: 2018-09-27 23:14:02,256 INFO   Validation loss: 0.267 acc: 0.895
7: 2018-09-27 23:14:02,265 INFO Epoch 1
6: 2018-09-27 23:14:02,314 INFO   Validation loss: 0.267 acc: 0.895
5: 2018-09-27 23:14:02,326 INFO Epoch 1
1: 2018-09-27 23:14:02,330 INFO   Validation loss: 0.267 acc: 0.895
1: 2018-09-27 23:14:02,437 INFO Epoch 1
2: 2018-09-27 23:14:02,478 INFO   Validation loss: 0.267 acc: 0.895
6: 2018-09-27 23:14:02,508 INFO Epoch 1
4: 2018-09-27 23:14:02,592 INFO   Validation loss: 0.267 acc: 0.895
2: 2018-09-27 23:14:02,609 INFO Epoch 1
4: 2018-09-27 23:14:02,724 INFO Epoch 1
0: 2018-09-27 23:14:03,192 INFO   Validation loss: 0.267 acc: 0.895
0: 2018-09-27 23:14:03,270 INFO Epoch 1
3: 2018-09-27 23:14:08,947 INFO   Validation loss: 0.267 acc: 0.895
3: 2018-09-27 23:14:09,012 INFO Epoch 1
0: 2018-09-27 23:14:22,368 INFO   Training loss: 0.247
1: 2018-09-27 23:14:22,367 INFO   Training loss: 0.250
7: 2018-09-27 23:14:22,369 INFO   Training loss: 0.254
4: 2018-09-27 23:14:22,367 INFO   Training loss: 0.242
3: 2018-09-27 23:14:22,368 INFO   Training loss: 0.257
5: 2018-09-27 23:14:22,368 INFO   Training loss: 0.253
6: 2018-09-27 23:14:22,371 INFO   Training loss: 0.243
2: 2018-09-27 23:14:22,369 INFO   Training loss: 0.246
2: 2018-09-27 23:14:45,840 INFO   Validation loss: 0.233 acc: 0.906
2: 2018-09-27 23:14:46,044 INFO Epoch 2
5: 2018-09-27 23:14:46,118 INFO   Validation loss: 0.233 acc: 0.906
5: 2018-09-27 23:14:46,204 INFO Epoch 2
3: 2018-09-27 23:14:46,218 INFO   Validation loss: 0.233 acc: 0.906
0: 2018-09-27 23:14:46,268 INFO   Validation loss: 0.233 acc: 0.906
7: 2018-09-27 23:14:46,309 INFO   Validation loss: 0.233 acc: 0.906
1: 2018-09-27 23:14:46,322 INFO   Validation loss: 0.233 acc: 0.906
4: 2018-09-27 23:14:46,416 INFO   Validation loss: 0.233 acc: 0.906
7: 2018-09-27 23:14:46,743 INFO Epoch 2
0: 2018-09-27 23:14:47,879 INFO Epoch 2
4: 2018-09-27 23:14:48,123 INFO Epoch 2
3: 2018-09-27 23:14:48,214 INFO Epoch 2
1: 2018-09-27 23:14:48,237 INFO Epoch 2
6: 2018-09-27 23:14:51,437 INFO   Validation loss: 0.233 acc: 0.906
6: 2018-09-27 23:14:51,549 INFO Epoch 2
0: 2018-09-27 23:15:04,559 INFO   Training loss: 0.236
6: 2018-09-27 23:15:04,562 INFO   Training loss: 0.231
7: 2018-09-27 23:15:04,560 INFO   Training loss: 0.242
4: 2018-09-27 23:15:04,557 INFO   Training loss: 0.232
3: 2018-09-27 23:15:04,558 INFO   Training loss: 0.245
5: 2018-09-27 23:15:04,558 INFO   Training loss: 0.242
2: 2018-09-27 23:15:04,559 INFO   Training loss: 0.233
1: 2018-09-27 23:15:04,557 INFO   Training loss: 0.239
6: 2018-09-27 23:15:27,866 INFO   Validation loss: 0.230 acc: 0.907
6: 2018-09-27 23:15:27,890 INFO Epoch 3
5: 2018-09-27 23:15:28,070 INFO   Validation loss: 0.230 acc: 0.907
2: 2018-09-27 23:15:28,074 INFO   Validation loss: 0.230 acc: 0.907
3: 2018-09-27 23:15:28,163 INFO   Validation loss: 0.230 acc: 0.907
5: 2018-09-27 23:15:28,170 INFO Epoch 3
4: 2018-09-27 23:15:28,240 INFO   Validation loss: 0.230 acc: 0.907
1: 2018-09-27 23:15:28,272 INFO   Validation loss: 0.230 acc: 0.907
0: 2018-09-27 23:15:28,274 INFO   Validation loss: 0.230 acc: 0.907
2: 2018-09-27 23:15:29,323 INFO Epoch 3
0: 2018-09-27 23:15:30,131 INFO Epoch 3
7: 2018-09-27 23:15:30,403 INFO   Validation loss: 0.230 acc: 0.907
4: 2018-09-27 23:15:30,918 INFO Epoch 3
3: 2018-09-27 23:15:31,101 INFO Epoch 3
7: 2018-09-27 23:15:31,138 INFO Epoch 3
1: 2018-09-27 23:15:31,170 INFO Epoch 3
4: 2018-09-27 23:15:44,561 INFO   Training loss: 0.229
3: 2018-09-27 23:15:44,562 INFO   Training loss: 0.241
2: 2018-09-27 23:15:44,563 INFO   Training loss: 0.229
0: 2018-09-27 23:15:44,563 INFO   Training loss: 0.233
6: 2018-09-27 23:15:44,566 INFO   Training loss: 0.227
5: 2018-09-27 23:15:44,562 INFO   Training loss: 0.239
7: 2018-09-27 23:15:44,564 INFO   Training loss: 0.238
1: 2018-09-27 23:15:44,562 INFO   Training loss: 0.235
6: 2018-09-27 23:16:08,254 INFO   Validation loss: 0.229 acc: 0.907
6: 2018-09-27 23:16:08,278 INFO Epoch 4
3: 2018-09-27 23:16:08,371 INFO   Validation loss: 0.229 acc: 0.907
1: 2018-09-27 23:16:08,406 INFO   Validation loss: 0.229 acc: 0.907
4: 2018-09-27 23:16:08,504 INFO   Validation loss: 0.229 acc: 0.907
0: 2018-09-27 23:16:08,542 INFO   Validation loss: 0.229 acc: 0.907
2: 2018-09-27 23:16:08,547 INFO   Validation loss: 0.229 acc: 0.907
5: 2018-09-27 23:16:08,662 INFO   Validation loss: 0.229 acc: 0.907
0: 2018-09-27 23:16:12,096 INFO Epoch 4
2: 2018-09-27 23:16:12,652 INFO Epoch 4
3: 2018-09-27 23:16:12,822 INFO Epoch 4
1: 2018-09-27 23:16:12,850 INFO Epoch 4
4: 2018-09-27 23:16:13,111 INFO Epoch 4
5: 2018-09-27 23:16:13,133 INFO Epoch 4
7: 2018-09-27 23:16:13,417 INFO   Validation loss: 0.229 acc: 0.907
7: 2018-09-27 23:16:13,446 INFO Epoch 4
7: 2018-09-27 23:16:26,954 INFO   Training loss: 0.235
6: 2018-09-27 23:16:26,956 INFO   Training loss: 0.227
3: 2018-09-27 23:16:26,953 INFO   Training loss: 0.237
0: 2018-09-27 23:16:26,954 INFO   Training loss: 0.233
5: 2018-09-27 23:16:26,953 INFO   Training loss: 0.237
2: 2018-09-27 23:16:26,954 INFO   Training loss: 0.228
4: 2018-09-27 23:16:26,953 INFO   Training loss: 0.226
1: 2018-09-27 23:16:26,953 INFO   Training loss: 0.234
6: 2018-09-27 23:16:50,419 INFO   Validation loss: 0.228 acc: 0.908
6: 2018-09-27 23:16:50,438 INFO Epoch 5
2: 2018-09-27 23:16:50,502 INFO   Validation loss: 0.228 acc: 0.908
3: 2018-09-27 23:16:50,576 INFO   Validation loss: 0.228 acc: 0.908
2: 2018-09-27 23:16:50,599 INFO Epoch 5
3: 2018-09-27 23:16:50,663 INFO Epoch 5
1: 2018-09-27 23:16:50,706 INFO   Validation loss: 0.228 acc: 0.908
5: 2018-09-27 23:16:50,718 INFO   Validation loss: 0.228 acc: 0.908
0: 2018-09-27 23:16:50,780 INFO   Validation loss: 0.228 acc: 0.908
4: 2018-09-27 23:16:50,828 INFO   Validation loss: 0.228 acc: 0.908
5: 2018-09-27 23:16:50,855 INFO Epoch 5
1: 2018-09-27 23:16:51,708 INFO Epoch 5
4: 2018-09-27 23:16:52,192 INFO Epoch 5
0: 2018-09-27 23:16:52,238 INFO Epoch 5
7: 2018-09-27 23:16:55,826 INFO   Validation loss: 0.228 acc: 0.908
7: 2018-09-27 23:16:56,082 INFO Epoch 5
4: 2018-09-27 23:17:09,650 INFO   Training loss: 0.226
3: 2018-09-27 23:17:09,651 INFO   Training loss: 0.237
6: 2018-09-27 23:17:09,655 INFO   Training loss: 0.224
7: 2018-09-27 23:17:09,653 INFO   Training loss: 0.234
5: 2018-09-27 23:17:09,651 INFO   Training loss: 0.235
2: 2018-09-27 23:17:09,653 INFO   Training loss: 0.225
1: 2018-09-27 23:17:09,652 INFO   Training loss: 0.233
0: 2018-09-27 23:17:09,654 INFO   Training loss: 0.231
6: 2018-09-27 23:17:33,086 INFO   Validation loss: 0.227 acc: 0.908
6: 2018-09-27 23:17:33,106 INFO Epoch 6
3: 2018-09-27 23:17:33,191 INFO   Validation loss: 0.227 acc: 0.908
3: 2018-09-27 23:17:33,268 INFO Epoch 6
5: 2018-09-27 23:17:33,343 INFO   Validation loss: 0.227 acc: 0.908
2: 2018-09-27 23:17:33,378 INFO   Validation loss: 0.227 acc: 0.908
1: 2018-09-27 23:17:33,442 INFO   Validation loss: 0.227 acc: 0.908
4: 2018-09-27 23:17:33,475 INFO   Validation loss: 0.227 acc: 0.908
2: 2018-09-27 23:17:33,594 INFO Epoch 6
0: 2018-09-27 23:17:33,945 INFO   Validation loss: 0.227 acc: 0.908
1: 2018-09-27 23:17:34,600 INFO Epoch 6
5: 2018-09-27 23:17:34,688 INFO Epoch 6
4: 2018-09-27 23:17:34,928 INFO Epoch 6
0: 2018-09-27 23:17:34,992 INFO Epoch 6
7: 2018-09-27 23:17:38,484 INFO   Validation loss: 0.227 acc: 0.908
7: 2018-09-27 23:17:38,554 INFO Epoch 6
4: 2018-09-27 23:17:52,065 INFO   Training loss: 0.224
7: 2018-09-27 23:17:52,068 INFO   Training loss: 0.233
0: 2018-09-27 23:17:52,068 INFO   Training loss: 0.230
5: 2018-09-27 23:17:52,067 INFO   Training loss: 0.234
2: 2018-09-27 23:17:52,067 INFO   Training loss: 0.224
1: 2018-09-27 23:17:52,066 INFO   Training loss: 0.229
6: 2018-09-27 23:17:52,071 INFO   Training loss: 0.224
3: 2018-09-27 23:17:52,068 INFO   Training loss: 0.235
6: 2018-09-27 23:18:15,434 INFO   Validation loss: 0.226 acc: 0.908
6: 2018-09-27 23:18:15,450 INFO Epoch 7
3: 2018-09-27 23:18:15,493 INFO   Validation loss: 0.226 acc: 0.908
2: 2018-09-27 23:18:15,614 INFO   Validation loss: 0.226 acc: 0.908
3: 2018-09-27 23:18:15,680 INFO Epoch 7
2: 2018-09-27 23:18:15,751 INFO Epoch 7
5: 2018-09-27 23:18:15,774 INFO   Validation loss: 0.226 acc: 0.908
1: 2018-09-27 23:18:15,822 INFO   Validation loss: 0.226 acc: 0.908
5: 2018-09-27 23:18:15,838 INFO Epoch 7
1: 2018-09-27 23:18:15,898 INFO Epoch 7
0: 2018-09-27 23:18:16,227 INFO   Validation loss: 0.226 acc: 0.908
4: 2018-09-27 23:18:16,226 INFO   Validation loss: 0.226 acc: 0.908
0: 2018-09-27 23:18:16,950 INFO Epoch 7
4: 2018-09-27 23:18:17,012 INFO Epoch 7
7: 2018-09-27 23:18:20,703 INFO   Validation loss: 0.226 acc: 0.908
7: 2018-09-27 23:18:20,749 INFO Epoch 7
7: 2018-09-27 23:18:34,285 INFO   Training loss: 0.233
5: 2018-09-27 23:18:34,284 INFO   Training loss: 0.232
1: 2018-09-27 23:18:34,283 INFO   Training loss: 0.229
6: 2018-09-27 23:18:34,287 INFO   Training loss: 0.223
4: 2018-09-27 23:18:34,283 INFO   Training loss: 0.224
3: 2018-09-27 23:18:34,284 INFO   Training loss: 0.235
2: 2018-09-27 23:18:34,285 INFO   Training loss: 0.223
0: 2018-09-27 23:18:34,285 INFO   Training loss: 0.231
2: 2018-09-27 23:18:57,801 INFO   Validation loss: 0.226 acc: 0.908
6: 2018-09-27 23:18:57,866 INFO   Validation loss: 0.226 acc: 0.908
3: 2018-09-27 23:18:57,862 INFO   Validation loss: 0.226 acc: 0.908
1: 2018-09-27 23:18:58,013 INFO   Validation loss: 0.226 acc: 0.908
2: 2018-09-27 23:18:58,114 INFO Finished training
2: 2018-09-27 23:18:58,114 INFO Train samples 8192 time 17.1757s rate 476.952 samples/s
2: 2018-09-27 23:18:58,114 INFO Valid rate: 1387.53 samples/s
2: 2018-09-27 23:18:58,114 INFO All done!
5: 2018-09-27 23:18:58,306 INFO   Validation loss: 0.226 acc: 0.908
0: 2018-09-27 23:18:58,350 INFO   Validation loss: 0.226 acc: 0.908
4: 2018-09-27 23:18:58,482 INFO   Validation loss: 0.226 acc: 0.908
6: 2018-09-27 23:18:59,857 INFO Finished training
6: 2018-09-27 23:18:59,858 INFO Train samples 8192 time 17.3464s rate 472.258 samples/s
6: 2018-09-27 23:18:59,858 INFO Valid rate: 1355.78 samples/s
6: 2018-09-27 23:18:59,858 INFO All done!
0: 2018-09-27 23:19:00,076 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-27 23:19:00,095 INFO Finished training
0: 2018-09-27 23:19:00,095 INFO Train samples 8192 time 16.3027s rate 502.493 samples/s
0: 2018-09-27 23:19:00,095 INFO Valid rate: 1363.47 samples/s
0: 2018-09-27 23:19:00,095 INFO All done!
3: 2018-09-27 23:19:00,285 INFO Finished training
3: 2018-09-27 23:19:00,285 INFO Train samples 8192 time 15.9012s rate 515.181 samples/s
3: 2018-09-27 23:19:00,285 INFO Valid rate: 1340.7 samples/s
3: 2018-09-27 23:19:00,285 INFO All done!
1: 2018-09-27 23:19:00,308 INFO Finished training
1: 2018-09-27 23:19:00,308 INFO Train samples 8192 time 16.3836s rate 500.013 samples/s
1: 2018-09-27 23:19:00,309 INFO Valid rate: 1379.58 samples/s
1: 2018-09-27 23:19:00,309 INFO All done!
5: 2018-09-27 23:19:00,630 INFO Finished training
5: 2018-09-27 23:19:00,630 INFO Train samples 8192 time 17.0937s rate 479.241 samples/s
5: 2018-09-27 23:19:00,630 INFO Valid rate: 1380.05 samples/s
5: 2018-09-27 23:19:00,630 INFO All done!
4: 2018-09-27 23:19:00,652 INFO Finished training
4: 2018-09-27 23:19:00,652 INFO Train samples 8192 time 16.1187s rate 508.229 samples/s
4: 2018-09-27 23:19:00,652 INFO Valid rate: 1369.07 samples/s
4: 2018-09-27 23:19:00,652 INFO All done!
7: 2018-09-27 23:19:02,961 INFO   Validation loss: 0.226 acc: 0.908
7: 2018-09-27 23:19:03,006 INFO Finished training
7: 2018-09-27 23:19:03,006 INFO Train samples 8192 time 14.8746s rate 550.736 samples/s
7: 2018-09-27 23:19:03,006 INFO Valid rate: 1207.78 samples/s
7: 2018-09-27 23:19:03,006 INFO All done!
