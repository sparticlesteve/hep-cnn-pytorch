*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
1: 2018-09-29 13:52:55,095 INFO Initializing
0: 2018-09-29 13:52:55,105 INFO Initializing
6: 2018-09-29 13:52:55,137 INFO Initializing
2: 2018-09-29 13:52:55,162 INFO Initializing
5: 2018-09-29 13:52:55,164 INFO Initializing
7: 2018-09-29 13:52:55,342 INFO Initializing
4: 2018-09-29 13:52:55,504 INFO Initializing
3: 2018-09-29 13:52:55,568 INFO Initializing
5: 2018-09-29 13:52:55,611 INFO MPI rank 5
0: 2018-09-29 13:52:55,614 INFO MPI rank 0
6: 2018-09-29 13:52:55,611 INFO MPI rank 6
1: 2018-09-29 13:52:55,611 INFO MPI rank 1
2: 2018-09-29 13:52:55,613 INFO MPI rank 2
4: 2018-09-29 13:52:55,611 INFO MPI rank 4
7: 2018-09-29 13:52:55,615 INFO MPI rank 7
3: 2018-09-29 13:52:55,614 INFO MPI rank 3
0: 2018-09-29 13:52:55,620 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 409600, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 2}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
5: 2018-09-29 13:55:33,397 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
1: 2018-09-29 13:55:33,398 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
3: 2018-09-29 13:55:33,401 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
4: 2018-09-29 13:55:33,398 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
2: 2018-09-29 13:55:33,445 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
0: 2018-09-29 13:55:33,464 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
7: 2018-09-29 13:55:34,079 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
6: 2018-09-29 13:55:34,726 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
3: 2018-09-29 13:55:34,743 INFO Epoch 0
1: 2018-09-29 13:55:34,740 INFO Epoch 0
2: 2018-09-29 13:55:34,742 INFO Epoch 0
0: 2018-09-29 13:55:34,743 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-29 13:55:34,743 INFO Epoch 0
5: 2018-09-29 13:55:34,748 INFO Epoch 0
4: 2018-09-29 13:55:34,748 INFO Epoch 0
6: 2018-09-29 13:55:34,749 INFO Epoch 0
7: 2018-09-29 13:55:34,752 INFO Epoch 0
7: 2018-09-29 13:56:35,327 INFO   Training loss: 0.281
3: 2018-09-29 13:56:35,327 INFO   Training loss: 0.277
4: 2018-09-29 13:56:35,324 INFO   Training loss: 0.277
6: 2018-09-29 13:56:35,324 INFO   Training loss: 0.284
5: 2018-09-29 13:56:35,323 INFO   Training loss: 0.282
1: 2018-09-29 13:56:35,324 INFO   Training loss: 0.280
2: 2018-09-29 13:56:35,326 INFO   Training loss: 0.278
0: 2018-09-29 13:56:35,327 INFO   Training loss: 0.283
7: 2018-09-29 13:56:45,888 INFO   Validation loss: 0.230 acc: 0.906
7: 2018-09-29 13:56:45,894 INFO Epoch 1
6: 2018-09-29 13:56:45,893 INFO   Validation loss: 0.230 acc: 0.906
0: 2018-09-29 13:56:45,913 INFO   Validation loss: 0.230 acc: 0.906
1: 2018-09-29 13:56:45,926 INFO   Validation loss: 0.230 acc: 0.906
5: 2018-09-29 13:56:45,953 INFO   Validation loss: 0.230 acc: 0.906
4: 2018-09-29 13:56:45,993 INFO   Validation loss: 0.230 acc: 0.906
6: 2018-09-29 13:56:48,608 INFO Epoch 1
0: 2018-09-29 13:56:48,635 INFO Epoch 1
1: 2018-09-29 13:56:48,768 INFO Epoch 1
5: 2018-09-29 13:56:48,792 INFO Epoch 1
4: 2018-09-29 13:56:48,815 INFO Epoch 1
2: 2018-09-29 13:56:50,952 INFO   Validation loss: 0.230 acc: 0.906
3: 2018-09-29 13:56:50,956 INFO   Validation loss: 0.230 acc: 0.906
2: 2018-09-29 13:56:52,207 INFO Epoch 1
3: 2018-09-29 13:56:52,262 INFO Epoch 1
7: 2018-09-29 13:57:51,942 INFO   Training loss: 0.231
3: 2018-09-29 13:57:51,941 INFO   Training loss: 0.230
6: 2018-09-29 13:57:51,938 INFO   Training loss: 0.235
1: 2018-09-29 13:57:51,938 INFO   Training loss: 0.229
2: 2018-09-29 13:57:51,940 INFO   Training loss: 0.229
4: 2018-09-29 13:57:51,938 INFO   Training loss: 0.230
0: 2018-09-29 13:57:51,941 INFO   Training loss: 0.232
5: 2018-09-29 13:57:51,938 INFO   Training loss: 0.233
0: 2018-09-29 13:58:02,560 INFO   Validation loss: 0.205 acc: 0.917
0: 2018-09-29 13:58:02,567 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
7: 2018-09-29 13:58:02,576 INFO   Validation loss: 0.205 acc: 0.917
0: 2018-09-29 13:58:02,579 INFO Finished training
0: 2018-09-29 13:58:02,579 INFO Train samples 51200 time 61.9447s rate 826.544 samples/s
0: 2018-09-29 13:58:02,580 INFO Valid rate: 3090.62 samples/s
0: 2018-09-29 13:58:02,580 INFO All done!
6: 2018-09-29 13:58:02,596 INFO   Validation loss: 0.205 acc: 0.917
3: 2018-09-29 13:58:02,638 INFO   Validation loss: 0.205 acc: 0.917
5: 2018-09-29 13:58:02,666 INFO   Validation loss: 0.205 acc: 0.917
4: 2018-09-29 13:58:02,679 INFO   Validation loss: 0.205 acc: 0.917
1: 2018-09-29 13:58:02,737 INFO   Validation loss: 0.205 acc: 0.917
6: 2018-09-29 13:58:04,001 INFO Finished training
6: 2018-09-29 13:58:04,001 INFO Train samples 51200 time 61.9531s rate 826.432 samples/s
6: 2018-09-29 13:58:04,002 INFO Valid rate: 3087.55 samples/s
6: 2018-09-29 13:58:04,002 INFO All done!
7: 2018-09-29 13:58:05,217 INFO Finished training
7: 2018-09-29 13:58:05,217 INFO Train samples 51200 time 63.3112s rate 808.704 samples/s
7: 2018-09-29 13:58:05,217 INFO Valid rate: 3092.16 samples/s
7: 2018-09-29 13:58:05,217 INFO All done!
3: 2018-09-29 13:58:05,293 INFO Finished training
3: 2018-09-29 13:58:05,293 INFO Train samples 51200 time 60.1312s rate 851.471 samples/s
3: 2018-09-29 13:58:05,294 INFO Valid rate: 2489.41 samples/s
3: 2018-09-29 13:58:05,294 INFO All done!
5: 2018-09-29 13:58:05,355 INFO Finished training
5: 2018-09-29 13:58:05,355 INFO Train samples 51200 time 61.8608s rate 827.664 samples/s
5: 2018-09-29 13:58:05,356 INFO Valid rate: 3068.48 samples/s
5: 2018-09-29 13:58:05,356 INFO All done!
4: 2018-09-29 13:58:05,457 INFO Finished training
4: 2018-09-29 13:58:05,457 INFO Train samples 51200 time 61.8493s rate 827.819 samples/s
4: 2018-09-29 13:58:05,458 INFO Valid rate: 3061.08 samples/s
4: 2018-09-29 13:58:05,458 INFO All done!
1: 2018-09-29 13:58:05,493 INFO Finished training
1: 2018-09-29 13:58:05,493 INFO Train samples 51200 time 61.8766s rate 827.454 samples/s
1: 2018-09-29 13:58:05,493 INFO Valid rate: 3062.44 samples/s
1: 2018-09-29 13:58:05,493 INFO All done!
2: 2018-09-29 13:58:07,593 INFO   Validation loss: 0.205 acc: 0.917
2: 2018-09-29 13:58:07,600 INFO Finished training
2: 2018-09-29 13:58:07,600 INFO Train samples 51200 time 60.1579s rate 851.093 samples/s
2: 2018-09-29 13:58:07,600 INFO Valid rate: 2095.23 samples/s
2: 2018-09-29 13:58:07,600 INFO All done!
