*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
0: 2018-09-28 11:27:16,604 INFO Initializing
1: 2018-09-28 11:27:16,785 INFO Initializing
0: 2018-09-28 11:27:16,842 INFO MPI rank 0
1: 2018-09-28 11:27:16,840 INFO MPI rank 1
0: 2018-09-28 11:27:16,852 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
1: 2018-09-28 11:27:52,620 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
0: 2018-09-28 11:27:52,623 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-28 11:27:52,644 INFO Epoch 0
0: 2018-09-28 11:27:52,646 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-28 11:27:52,646 INFO Epoch 0
0: 2018-09-28 11:28:27,988 INFO   Training loss: 0.381
1: 2018-09-28 11:28:27,986 INFO   Training loss: 0.382
0: 2018-09-28 11:28:38,575 INFO   Validation loss: 0.259 acc: 0.891
0: 2018-09-28 11:28:38,582 INFO Epoch 1
1: 2018-09-28 11:28:38,686 INFO   Validation loss: 0.259 acc: 0.891
1: 2018-09-28 11:28:38,798 INFO Epoch 1
1: 2018-09-28 11:29:12,481 INFO   Training loss: 0.246
0: 2018-09-28 11:29:12,483 INFO   Training loss: 0.247
0: 2018-09-28 11:29:23,244 INFO   Validation loss: 0.235 acc: 0.904
0: 2018-09-28 11:29:23,257 INFO Epoch 2
1: 2018-09-28 11:29:23,361 INFO   Validation loss: 0.235 acc: 0.904
1: 2018-09-28 11:29:23,426 INFO Epoch 2
0: 2018-09-28 11:30:00,667 INFO   Training loss: 0.239
1: 2018-09-28 11:30:00,665 INFO   Training loss: 0.239
1: 2018-09-28 11:30:11,446 INFO   Validation loss: 0.230 acc: 0.907
1: 2018-09-28 11:30:11,452 INFO Epoch 3
0: 2018-09-28 11:30:17,420 INFO   Validation loss: 0.230 acc: 0.907
0: 2018-09-28 11:30:17,925 INFO Epoch 3
0: 2018-09-28 11:30:55,583 INFO   Training loss: 0.230
1: 2018-09-28 11:30:55,581 INFO   Training loss: 0.229
1: 2018-09-28 11:31:06,468 INFO   Validation loss: 0.222 acc: 0.907
1: 2018-09-28 11:31:06,482 INFO Epoch 4
0: 2018-09-28 11:31:12,469 INFO   Validation loss: 0.222 acc: 0.907
0: 2018-09-28 11:31:12,479 INFO Epoch 4
0: 2018-09-28 11:31:50,331 INFO   Training loss: 0.165
1: 2018-09-28 11:31:50,329 INFO   Training loss: 0.166
1: 2018-09-28 11:32:01,254 INFO   Validation loss: 0.187 acc: 0.919
1: 2018-09-28 11:32:01,265 INFO Epoch 5
0: 2018-09-28 11:32:07,235 INFO   Validation loss: 0.187 acc: 0.919
0: 2018-09-28 11:32:07,245 INFO Epoch 5
0: 2018-09-28 11:32:44,272 INFO   Training loss: 0.074
1: 2018-09-28 11:32:44,270 INFO   Training loss: 0.075
1: 2018-09-28 11:32:55,244 INFO   Validation loss: 0.050 acc: 0.982
1: 2018-09-28 11:32:55,250 INFO Epoch 6
0: 2018-09-28 11:33:01,245 INFO   Validation loss: 0.050 acc: 0.982
0: 2018-09-28 11:33:01,268 INFO Epoch 6
1: 2018-09-28 11:33:38,994 INFO   Training loss: 0.051
0: 2018-09-28 11:33:38,997 INFO   Training loss: 0.051
1: 2018-09-28 11:33:50,148 INFO   Validation loss: 0.038 acc: 0.987
1: 2018-09-28 11:33:50,155 INFO Epoch 7
0: 2018-09-28 11:33:56,173 INFO   Validation loss: 0.038 acc: 0.987
0: 2018-09-28 11:33:56,183 INFO Epoch 7
1: 2018-09-28 11:34:33,518 INFO   Training loss: 0.056
0: 2018-09-28 11:34:33,520 INFO   Training loss: 0.053
1: 2018-09-28 11:34:44,554 INFO   Validation loss: 0.042 acc: 0.986
1: 2018-09-28 11:34:44,563 INFO Finished training
1: 2018-09-28 11:34:44,563 INFO Train samples 32768 time 40.5441s rate 808.207 samples/s
1: 2018-09-28 11:34:44,563 INFO Valid rate: 3001.71 samples/s
1: 2018-09-28 11:34:44,563 INFO All done!
0: 2018-09-28 11:34:50,563 INFO   Validation loss: 0.042 acc: 0.986
0: 2018-09-28 11:34:50,583 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-28 11:34:50,611 INFO Finished training
0: 2018-09-28 11:34:50,611 INFO Train samples 32768 time 36.7819s rate 890.872 samples/s
0: 2018-09-28 11:34:50,611 INFO Valid rate: 2129.92 samples/s
0: 2018-09-28 11:34:50,611 INFO All done!
