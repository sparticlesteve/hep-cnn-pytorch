*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
1: 2018-09-29 17:05:51,168 INFO Initializing
3: 2018-09-29 17:05:51,172 INFO Initializing
0: 2018-09-29 17:05:51,177 INFO Initializing
2: 2018-09-29 17:05:51,212 INFO Initializing
0: 2018-09-29 17:05:51,256 INFO MPI rank 0
1: 2018-09-29 17:05:51,260 INFO MPI rank 1
3: 2018-09-29 17:05:51,256 INFO MPI rank 3
2: 2018-09-29 17:05:51,260 INFO MPI rank 2
0: 2018-09-29 17:05:51,260 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 409600, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 2}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
1: 2018-09-29 17:09:55,453 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
0: 2018-09-29 17:09:55,450 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
2: 2018-09-29 17:09:55,454 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
3: 2018-09-29 17:09:55,455 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
2: 2018-09-29 17:09:55,491 INFO Epoch 0
1: 2018-09-29 17:09:55,492 INFO Epoch 0
0: 2018-09-29 17:09:55,489 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-29 17:09:55,489 INFO Epoch 0
3: 2018-09-29 17:09:55,488 INFO Epoch 0
1: 2018-09-29 17:12:39,714 INFO   Training loss: 0.256
2: 2018-09-29 17:12:39,714 INFO   Training loss: 0.257
3: 2018-09-29 17:12:39,711 INFO   Training loss: 0.259
0: 2018-09-29 17:12:39,726 INFO   Training loss: 0.257
1: 2018-09-29 17:12:53,823 INFO   Validation loss: 0.188 acc: 0.924
1: 2018-09-29 17:12:54,429 INFO Epoch 1
3: 2018-09-29 17:12:55,583 INFO   Validation loss: 0.188 acc: 0.924
3: 2018-09-29 17:12:55,755 INFO Epoch 1
0: 2018-09-29 17:12:56,996 INFO   Validation loss: 0.188 acc: 0.924
0: 2018-09-29 17:12:57,089 INFO Epoch 1
2: 2018-09-29 17:12:58,807 INFO   Validation loss: 0.188 acc: 0.924
2: 2018-09-29 17:12:58,861 INFO Epoch 1
1: 2018-09-29 17:15:44,583 INFO   Training loss: 0.115
2: 2018-09-29 17:15:44,588 INFO   Training loss: 0.114
0: 2018-09-29 17:15:44,590 INFO   Training loss: 0.115
3: 2018-09-29 17:15:44,596 INFO   Training loss: 0.116
1: 2018-09-29 17:16:05,586 INFO   Validation loss: 0.039 acc: 0.987
1: 2018-09-29 17:16:05,593 INFO Finished training
1: 2018-09-29 17:16:05,593 INFO Train samples 102400 time 167.188s rate 612.484 samples/s
1: 2018-09-29 17:16:05,593 INFO Valid rate: 1866.55 samples/s
1: 2018-09-29 17:16:05,594 INFO All done!
3: 2018-09-29 17:16:05,590 INFO   Validation loss: 0.039 acc: 0.987
3: 2018-09-29 17:16:05,679 INFO Finished training
3: 2018-09-29 17:16:05,679 INFO Train samples 102400 time 166.532s rate 614.898 samples/s
3: 2018-09-29 17:16:05,680 INFO Valid rate: 1777.71 samples/s
3: 2018-09-29 17:16:05,680 INFO All done!
2: 2018-09-29 17:16:10,587 INFO   Validation loss: 0.039 acc: 0.987
2: 2018-09-29 17:16:10,651 INFO Finished training
2: 2018-09-29 17:16:10,651 INFO Train samples 102400 time 164.975s rate 620.7 samples/s
2: 2018-09-29 17:16:10,651 INFO Valid rate: 1453.43 samples/s
2: 2018-09-29 17:16:10,651 INFO All done!
0: 2018-09-29 17:16:10,898 INFO   Validation loss: 0.039 acc: 0.987
0: 2018-09-29 17:16:10,980 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-29 17:16:11,007 INFO Finished training
0: 2018-09-29 17:16:11,007 INFO Train samples 102400 time 165.869s rate 617.354 samples/s
0: 2018-09-29 17:16:11,007 INFO Valid rate: 1503.9 samples/s
0: 2018-09-29 17:16:11,007 INFO All done!
