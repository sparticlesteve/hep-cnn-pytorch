*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
7: 2018-09-29 17:20:04,979 INFO Initializing
6: 2018-09-29 17:20:04,982 INFO Initializing
3: 2018-09-29 17:20:05,006 INFO Initializing
0: 2018-09-29 17:20:05,048 INFO Initializing
4: 2018-09-29 17:20:05,052 INFO Initializing
1: 2018-09-29 17:20:05,064 INFO Initializing
2: 2018-09-29 17:20:05,070 INFO Initializing
5: 2018-09-29 17:20:05,106 INFO Initializing
7: 2018-09-29 17:20:05,153 INFO MPI rank 7
6: 2018-09-29 17:20:05,156 INFO MPI rank 6
3: 2018-09-29 17:20:05,152 INFO MPI rank 3
1: 2018-09-29 17:20:05,155 INFO MPI rank 1
5: 2018-09-29 17:20:05,153 INFO MPI rank 5
2: 2018-09-29 17:20:05,152 INFO MPI rank 2
4: 2018-09-29 17:20:05,157 INFO MPI rank 4
0: 2018-09-29 17:20:05,156 INFO MPI rank 0
0: 2018-09-29 17:20:05,164 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 409600, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 2}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
7: 2018-09-29 17:24:21,226 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
5: 2018-09-29 17:24:21,226 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
2: 2018-09-29 17:24:21,255 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
3: 2018-09-29 17:24:21,820 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
1: 2018-09-29 17:24:22,101 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
0: 2018-09-29 17:24:22,367 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
6: 2018-09-29 17:24:22,402 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
4: 2018-09-29 17:24:22,404 INFO Loaded data with shape: torch.Size([409600, 1, 64, 64])
3: 2018-09-29 17:24:22,425 INFO Epoch 0
1: 2018-09-29 17:24:22,428 INFO Epoch 0
6: 2018-09-29 17:24:22,430 INFO Epoch 0
2: 2018-09-29 17:24:22,425 INFO Epoch 0
4: 2018-09-29 17:24:22,431 INFO Epoch 0
0: 2018-09-29 17:24:22,430 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-29 17:24:22,430 INFO Epoch 0
7: 2018-09-29 17:24:22,428 INFO Epoch 0
5: 2018-09-29 17:24:22,427 INFO Epoch 0
7: 2018-09-29 17:25:49,350 INFO   Training loss: 0.470
6: 2018-09-29 17:25:49,354 INFO   Training loss: 0.472
2: 2018-09-29 17:25:49,349 INFO   Training loss: 0.468
4: 2018-09-29 17:25:49,355 INFO   Training loss: 0.468
3: 2018-09-29 17:25:49,350 INFO   Training loss: 0.468
5: 2018-09-29 17:25:49,352 INFO   Training loss: 0.473
0: 2018-09-29 17:25:49,356 INFO   Training loss: 0.469
1: 2018-09-29 17:25:49,358 INFO   Training loss: 0.472
5: 2018-09-29 17:26:12,982 INFO   Validation loss: 0.227 acc: 0.907
5: 2018-09-29 17:26:12,998 INFO Epoch 1
7: 2018-09-29 17:26:13,131 INFO   Validation loss: 0.227 acc: 0.907
0: 2018-09-29 17:26:13,175 INFO   Validation loss: 0.227 acc: 0.907
6: 2018-09-29 17:26:13,306 INFO   Validation loss: 0.227 acc: 0.907
1: 2018-09-29 17:26:13,571 INFO   Validation loss: 0.227 acc: 0.907
0: 2018-09-29 17:26:13,579 INFO Epoch 1
3: 2018-09-29 17:26:13,677 INFO   Validation loss: 0.227 acc: 0.907
7: 2018-09-29 17:26:14,094 INFO Epoch 1
6: 2018-09-29 17:26:14,768 INFO Epoch 1
3: 2018-09-29 17:26:14,889 INFO Epoch 1
1: 2018-09-29 17:26:14,946 INFO Epoch 1
4: 2018-09-29 17:26:19,913 INFO   Validation loss: 0.227 acc: 0.907
4: 2018-09-29 17:26:19,951 INFO Epoch 1
2: 2018-09-29 17:26:20,042 INFO   Validation loss: 0.227 acc: 0.907
2: 2018-09-29 17:26:20,127 INFO Epoch 1
7: 2018-09-29 17:27:47,461 INFO   Training loss: 0.231
3: 2018-09-29 17:27:47,460 INFO   Training loss: 0.230
5: 2018-09-29 17:27:47,461 INFO   Training loss: 0.234
1: 2018-09-29 17:27:47,464 INFO   Training loss: 0.231
2: 2018-09-29 17:27:47,462 INFO   Training loss: 0.230
0: 2018-09-29 17:27:47,475 INFO   Training loss: 0.234
4: 2018-09-29 17:27:47,478 INFO   Training loss: 0.232
6: 2018-09-29 17:27:47,480 INFO   Training loss: 0.236
7: 2018-09-29 17:28:10,983 INFO   Validation loss: 0.226 acc: 0.909
7: 2018-09-29 17:28:10,999 INFO Finished training
7: 2018-09-29 17:28:10,999 INFO Train samples 51200 time 90.1445s rate 567.977 samples/s
7: 2018-09-29 17:28:10,999 INFO Valid rate: 1385.45 samples/s
7: 2018-09-29 17:28:11,000 INFO All done!
6: 2018-09-29 17:28:11,340 INFO   Validation loss: 0.226 acc: 0.909
1: 2018-09-29 17:28:11,339 INFO   Validation loss: 0.226 acc: 0.909
5: 2018-09-29 17:28:11,410 INFO   Validation loss: 0.226 acc: 0.909
0: 2018-09-29 17:28:11,643 INFO   Validation loss: 0.226 acc: 0.909
3: 2018-09-29 17:28:11,708 INFO   Validation loss: 0.226 acc: 0.909
1: 2018-09-29 17:28:12,955 INFO Finished training
1: 2018-09-29 17:28:12,956 INFO Train samples 51200 time 89.7239s rate 570.64 samples/s
1: 2018-09-29 17:28:12,956 INFO Valid rate: 1362.87 samples/s
1: 2018-09-29 17:28:12,956 INFO All done!
0: 2018-09-29 17:28:12,988 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-29 17:28:13,008 INFO Finished training
0: 2018-09-29 17:28:13,008 INFO Train samples 51200 time 90.4113s rate 566.301 samples/s
0: 2018-09-29 17:28:13,008 INFO Valid rate: 1365.74 samples/s
0: 2018-09-29 17:28:13,008 INFO All done!
5: 2018-09-29 17:28:13,577 INFO Finished training
5: 2018-09-29 17:28:13,577 INFO Train samples 51200 time 90.6935s rate 564.539 samples/s
5: 2018-09-29 17:28:13,577 INFO Valid rate: 1377.43 samples/s
5: 2018-09-29 17:28:13,577 INFO All done!
6: 2018-09-29 17:28:13,616 INFO Finished training
6: 2018-09-29 17:28:13,616 INFO Train samples 51200 time 89.8175s rate 570.045 samples/s
6: 2018-09-29 17:28:13,616 INFO Valid rate: 1370.69 samples/s
6: 2018-09-29 17:28:13,616 INFO All done!
3: 2018-09-29 17:28:13,656 INFO Finished training
3: 2018-09-29 17:28:13,656 INFO Train samples 51200 time 89.7479s rate 570.487 samples/s
3: 2018-09-29 17:28:13,656 INFO Valid rate: 1349.21 samples/s
3: 2018-09-29 17:28:13,656 INFO All done!
2: 2018-09-29 17:28:16,162 INFO   Validation loss: 0.226 acc: 0.909
4: 2018-09-29 17:28:16,214 INFO   Validation loss: 0.226 acc: 0.909
2: 2018-09-29 17:28:17,679 INFO Finished training
2: 2018-09-29 17:28:17,680 INFO Train samples 51200 time 87.1289s rate 587.635 samples/s
2: 2018-09-29 17:28:17,680 INFO Valid rate: 1103.43 samples/s
2: 2018-09-29 17:28:17,680 INFO All done!
4: 2018-09-29 17:28:17,724 INFO Finished training
4: 2018-09-29 17:28:17,724 INFO Train samples 51200 time 87.2251s rate 586.987 samples/s
4: 2018-09-29 17:28:17,724 INFO Valid rate: 1105.28 samples/s
4: 2018-09-29 17:28:17,725 INFO All done!
