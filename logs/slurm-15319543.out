*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
0: 2018-09-28 11:35:58,807 INFO Initializing
3: 2018-09-28 11:35:58,942 INFO Initializing
2: 2018-09-28 11:35:59,138 INFO Initializing
1: 2018-09-28 11:35:59,138 INFO Initializing
2: 2018-09-28 11:35:59,194 INFO MPI rank 2
0: 2018-09-28 11:35:59,195 INFO MPI rank 0
3: 2018-09-28 11:35:59,193 INFO MPI rank 3
1: 2018-09-28 11:35:59,193 INFO MPI rank 1
0: 2018-09-28 11:35:59,201 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
0: 2018-09-28 11:36:34,662 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
2: 2018-09-28 11:36:34,661 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-28 11:36:34,663 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
3: 2018-09-28 11:36:34,664 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-28 11:36:34,681 INFO Epoch 0
2: 2018-09-28 11:36:34,682 INFO Epoch 0
0: 2018-09-28 11:36:34,683 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
3: 2018-09-28 11:36:34,682 INFO Epoch 0
0: 2018-09-28 11:36:34,683 INFO Epoch 0
0: 2018-09-28 11:36:54,140 INFO   Training loss: 0.397
2: 2018-09-28 11:36:54,139 INFO   Training loss: 0.398
3: 2018-09-28 11:36:54,139 INFO   Training loss: 0.400
1: 2018-09-28 11:36:54,138 INFO   Training loss: 0.402
3: 2018-09-28 11:37:04,704 INFO   Validation loss: 0.247 acc: 0.901
3: 2018-09-28 11:37:04,711 INFO Epoch 1
1: 2018-09-28 11:37:04,776 INFO   Validation loss: 0.247 acc: 0.901
2: 2018-09-28 11:37:04,821 INFO   Validation loss: 0.247 acc: 0.901
1: 2018-09-28 11:37:05,941 INFO Epoch 1
2: 2018-09-28 11:37:05,968 INFO Epoch 1
0: 2018-09-28 11:37:11,234 INFO   Validation loss: 0.247 acc: 0.901
0: 2018-09-28 11:37:11,320 INFO Epoch 1
2: 2018-09-28 11:37:30,252 INFO   Training loss: 0.259
0: 2018-09-28 11:37:30,253 INFO   Training loss: 0.261
3: 2018-09-28 11:37:30,252 INFO   Training loss: 0.260
1: 2018-09-28 11:37:30,251 INFO   Training loss: 0.261
3: 2018-09-28 11:37:40,834 INFO   Validation loss: 0.234 acc: 0.907
3: 2018-09-28 11:37:40,842 INFO Epoch 2
1: 2018-09-28 11:37:40,870 INFO   Validation loss: 0.234 acc: 0.907
0: 2018-09-28 11:37:40,895 INFO   Validation loss: 0.234 acc: 0.907
2: 2018-09-28 11:37:40,980 INFO   Validation loss: 0.234 acc: 0.907
1: 2018-09-28 11:37:41,034 INFO Epoch 2
0: 2018-09-28 11:37:41,143 INFO Epoch 2
2: 2018-09-28 11:37:41,216 INFO Epoch 2
0: 2018-09-28 11:37:59,782 INFO   Training loss: 0.249
3: 2018-09-28 11:37:59,781 INFO   Training loss: 0.250
1: 2018-09-28 11:37:59,780 INFO   Training loss: 0.250
2: 2018-09-28 11:37:59,782 INFO   Training loss: 0.250
3: 2018-09-28 11:38:10,384 INFO   Validation loss: 0.232 acc: 0.908
3: 2018-09-28 11:38:10,391 INFO Epoch 3
2: 2018-09-28 11:38:10,391 INFO   Validation loss: 0.232 acc: 0.908
1: 2018-09-28 11:38:10,408 INFO   Validation loss: 0.232 acc: 0.908
0: 2018-09-28 11:38:10,489 INFO   Validation loss: 0.232 acc: 0.908
1: 2018-09-28 11:38:10,756 INFO Epoch 3
2: 2018-09-28 11:38:10,882 INFO Epoch 3
0: 2018-09-28 11:38:10,922 INFO Epoch 3
0: 2018-09-28 11:38:29,673 INFO   Training loss: 0.241
3: 2018-09-28 11:38:29,672 INFO   Training loss: 0.242
2: 2018-09-28 11:38:29,673 INFO   Training loss: 0.243
1: 2018-09-28 11:38:29,672 INFO   Training loss: 0.243
3: 2018-09-28 11:38:40,326 INFO   Validation loss: 0.230 acc: 0.906
3: 2018-09-28 11:38:40,334 INFO Epoch 4
1: 2018-09-28 11:38:40,362 INFO   Validation loss: 0.230 acc: 0.906
0: 2018-09-28 11:38:40,420 INFO   Validation loss: 0.230 acc: 0.906
2: 2018-09-28 11:38:40,436 INFO   Validation loss: 0.230 acc: 0.906
0: 2018-09-28 11:38:41,148 INFO Epoch 4
1: 2018-09-28 11:38:41,374 INFO Epoch 4
2: 2018-09-28 11:38:41,410 INFO Epoch 4
0: 2018-09-28 11:39:00,354 INFO   Training loss: 0.240
3: 2018-09-28 11:39:00,353 INFO   Training loss: 0.237
2: 2018-09-28 11:39:00,354 INFO   Training loss: 0.240
1: 2018-09-28 11:39:00,353 INFO   Training loss: 0.239
3: 2018-09-28 11:39:10,970 INFO   Validation loss: 0.227 acc: 0.907
3: 2018-09-28 11:39:10,980 INFO Epoch 5
2: 2018-09-28 11:39:11,015 INFO   Validation loss: 0.227 acc: 0.907
1: 2018-09-28 11:39:11,029 INFO   Validation loss: 0.227 acc: 0.907
2: 2018-09-28 11:39:12,432 INFO Epoch 5
1: 2018-09-28 11:39:12,464 INFO Epoch 5
0: 2018-09-28 11:39:16,037 INFO   Validation loss: 0.227 acc: 0.907
0: 2018-09-28 11:39:16,066 INFO Epoch 5
1: 2018-09-28 11:39:35,198 INFO   Training loss: 0.236
2: 2018-09-28 11:39:35,200 INFO   Training loss: 0.237
0: 2018-09-28 11:39:35,200 INFO   Training loss: 0.234
3: 2018-09-28 11:39:35,199 INFO   Training loss: 0.236
3: 2018-09-28 11:39:45,791 INFO   Validation loss: 0.226 acc: 0.908
3: 2018-09-28 11:39:45,800 INFO Epoch 6
1: 2018-09-28 11:39:45,820 INFO   Validation loss: 0.226 acc: 0.908
2: 2018-09-28 11:39:45,831 INFO   Validation loss: 0.226 acc: 0.908
1: 2018-09-28 11:39:47,127 INFO Epoch 6
2: 2018-09-28 11:39:47,153 INFO Epoch 6
0: 2018-09-28 11:39:50,848 INFO   Validation loss: 0.226 acc: 0.908
0: 2018-09-28 11:39:50,904 INFO Epoch 6
0: 2018-09-28 11:40:10,219 INFO   Training loss: 0.232
3: 2018-09-28 11:40:10,218 INFO   Training loss: 0.231
2: 2018-09-28 11:40:10,218 INFO   Training loss: 0.232
1: 2018-09-28 11:40:10,217 INFO   Training loss: 0.233
3: 2018-09-28 11:40:20,877 INFO   Validation loss: 0.218 acc: 0.912
3: 2018-09-28 11:40:20,885 INFO Epoch 7
1: 2018-09-28 11:40:20,929 INFO   Validation loss: 0.218 acc: 0.912
2: 2018-09-28 11:40:20,935 INFO   Validation loss: 0.218 acc: 0.912
1: 2018-09-28 11:40:22,180 INFO Epoch 7
2: 2018-09-28 11:40:22,199 INFO Epoch 7
0: 2018-09-28 11:40:26,007 INFO   Validation loss: 0.218 acc: 0.912
0: 2018-09-28 11:40:26,098 INFO Epoch 7
3: 2018-09-28 11:40:44,872 INFO   Training loss: 0.213
0: 2018-09-28 11:40:44,873 INFO   Training loss: 0.210
1: 2018-09-28 11:40:44,872 INFO   Training loss: 0.211
2: 2018-09-28 11:40:44,873 INFO   Training loss: 0.208
3: 2018-09-28 11:40:55,549 INFO   Validation loss: 0.189 acc: 0.924
3: 2018-09-28 11:40:55,598 INFO Finished training
3: 2018-09-28 11:40:55,598 INFO Train samples 16384 time 21.9823s rate 745.327 samples/s
3: 2018-09-28 11:40:55,598 INFO Valid rate: 3085.99 samples/s
3: 2018-09-28 11:40:55,598 INFO All done!
1: 2018-09-28 11:40:55,625 INFO   Validation loss: 0.189 acc: 0.924
2: 2018-09-28 11:40:55,683 INFO   Validation loss: 0.189 acc: 0.924
2: 2018-09-28 11:40:55,830 INFO Finished training
2: 2018-09-28 11:40:55,831 INFO Train samples 16384 time 21.0684s rate 777.656 samples/s
2: 2018-09-28 11:40:55,831 INFO Valid rate: 3062.42 samples/s
2: 2018-09-28 11:40:55,831 INFO All done!
1: 2018-09-28 11:40:55,905 INFO Finished training
1: 2018-09-28 11:40:55,906 INFO Train samples 16384 time 21.1153s rate 775.929 samples/s
1: 2018-09-28 11:40:55,906 INFO Valid rate: 3072.04 samples/s
1: 2018-09-28 11:40:55,906 INFO All done!
0: 2018-09-28 11:41:00,686 INFO   Validation loss: 0.189 acc: 0.924
0: 2018-09-28 11:41:00,700 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-28 11:41:00,717 INFO Finished training
0: 2018-09-28 11:41:00,717 INFO Train samples 16384 time 19.0263s rate 861.123 samples/s
0: 2018-09-28 11:41:00,717 INFO Valid rate: 2338.1 samples/s
0: 2018-09-28 11:41:00,717 INFO All done!
