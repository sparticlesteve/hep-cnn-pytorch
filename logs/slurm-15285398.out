*** WARNING: This is an experimental installation of pytorch built specifically for MPI / distributed running ***
0: 2018-09-27 22:49:00,055 INFO Initializing
1: 2018-09-27 22:49:00,128 INFO Initializing
0: 2018-09-27 22:49:00,176 INFO MPI rank 0
1: 2018-09-27 22:49:00,177 INFO MPI rank 1
0: 2018-09-27 22:49:00,184 INFO Configuration: {'data_config': {'train_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/train.h5', 'valid_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/val.h5', 'test_file': '/global/cscratch1/sd/sfarrell/atlas-rpv-images/test.h5', 'n_train': 65536, 'n_valid': 32768, 'n_test': 1024}, 'model_config': {'conv_sizes': [16, 32, 64], 'dense_sizes': [128], 'optimizer': 'Adam', 'learning_rate': 0.001, 'dropout': 0.2}, 'training_config': {'batch_size': 128, 'n_epochs': 8}, 'output_dir': '$SCRATCH/hep-cnn-pytorch'}
0: 2018-09-27 22:49:43,682 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-27 22:49:44,024 INFO Loaded data with shape: torch.Size([65536, 1, 64, 64])
1: 2018-09-27 22:49:44,056 INFO Epoch 0
0: 2018-09-27 22:49:44,057 INFO Model: 
0: HEPCNNClassifier(
0:   (conv_net): Sequential(
0:     (0): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (1): ReLU()
0:     (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (4): ReLU()
0:     (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:     (6): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
0:     (7): ReLU()
0:     (8): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
0:   )
0:   (dense_net): Sequential(
0:     (0): Linear(in_features=4096, out_features=128, bias=True)
0:     (1): ReLU()
0:     (2): Dropout(p=0.2)
0:     (3): Linear(in_features=128, out_features=1, bias=True)
0:     (4): Sigmoid()
0:   )
0: )
0: Parameters: 547841
0: 2018-09-27 22:49:44,057 INFO Epoch 0
1: 2018-09-27 22:50:26,339 INFO   Training loss: 0.324
0: 2018-09-27 22:50:26,341 INFO   Training loss: 0.324
1: 2018-09-27 22:50:37,289 INFO   Validation loss: 0.250 acc: 0.896
1: 2018-09-27 22:50:37,301 INFO Epoch 1
0: 2018-09-27 22:50:42,266 INFO   Validation loss: 0.250 acc: 0.896
0: 2018-09-27 22:50:42,347 INFO Epoch 1
1: 2018-09-27 22:51:22,468 INFO   Training loss: 0.245
0: 2018-09-27 22:51:22,483 INFO   Training loss: 0.244
0: 2018-09-27 22:51:35,874 INFO   Validation loss: 0.231 acc: 0.907
0: 2018-09-27 22:51:35,883 INFO Epoch 2
1: 2018-09-27 22:51:36,201 INFO   Validation loss: 0.231 acc: 0.907
1: 2018-09-27 22:51:36,287 INFO Epoch 2
0: 2018-09-27 22:52:14,647 INFO   Training loss: 0.239
1: 2018-09-27 22:52:14,650 INFO   Training loss: 0.240
1: 2018-09-27 22:52:27,767 INFO   Validation loss: 0.225 acc: 0.909
1: 2018-09-27 22:52:28,266 INFO Epoch 3
0: 2018-09-27 22:52:29,253 INFO   Validation loss: 0.225 acc: 0.909
0: 2018-09-27 22:52:29,332 INFO Epoch 3
1: 2018-09-27 22:53:07,631 INFO   Training loss: 0.224
0: 2018-09-27 22:53:07,631 INFO   Training loss: 0.224
1: 2018-09-27 22:53:18,868 INFO   Validation loss: 0.163 acc: 0.934
1: 2018-09-27 22:53:18,875 INFO Epoch 4
0: 2018-09-27 22:53:18,916 INFO   Validation loss: 0.163 acc: 0.934
0: 2018-09-27 22:53:18,994 INFO Epoch 4
0: 2018-09-27 22:53:56,774 INFO   Training loss: 0.148
1: 2018-09-27 22:53:56,775 INFO   Training loss: 0.152
0: 2018-09-27 22:54:07,851 INFO   Validation loss: 0.081 acc: 0.968
0: 2018-09-27 22:54:07,859 INFO Epoch 5
1: 2018-09-27 22:54:09,276 INFO   Validation loss: 0.081 acc: 0.968
1: 2018-09-27 22:54:09,358 INFO Epoch 5
1: 2018-09-27 22:54:50,922 INFO   Training loss: 0.067
0: 2018-09-27 22:54:50,924 INFO   Training loss: 0.064
1: 2018-09-27 22:55:02,162 INFO   Validation loss: 0.039 acc: 0.986
1: 2018-09-27 22:55:02,172 INFO Epoch 6
0: 2018-09-27 22:55:02,417 INFO   Validation loss: 0.039 acc: 0.986
0: 2018-09-27 22:55:02,496 INFO Epoch 6
0: 2018-09-27 22:55:43,625 INFO   Training loss: 0.049
1: 2018-09-27 22:55:43,628 INFO   Training loss: 0.049
1: 2018-09-27 22:55:54,938 INFO   Validation loss: 0.037 acc: 0.987
1: 2018-09-27 22:55:54,945 INFO Epoch 7
0: 2018-09-27 22:55:59,402 INFO   Validation loss: 0.037 acc: 0.987
0: 2018-09-27 22:55:59,527 INFO Epoch 7
1: 2018-09-27 22:56:38,865 INFO   Training loss: 0.041
0: 2018-09-27 22:56:38,866 INFO   Training loss: 0.042
1: 2018-09-27 22:56:49,982 INFO   Validation loss: 0.083 acc: 0.972
1: 2018-09-27 22:56:49,995 INFO Finished training
1: 2018-09-27 22:56:49,995 INFO Train samples 32768 time 41.2523s rate 794.332 samples/s
1: 2018-09-27 22:56:49,995 INFO Valid rate: 2753.59 samples/s
1: 2018-09-27 22:56:49,996 INFO All done!
0: 2018-09-27 22:56:53,768 INFO   Validation loss: 0.083 acc: 0.972
0: 2018-09-27 22:56:53,890 INFO Saving summaries to /global/cscratch1/sd/sfarrell/hep-cnn-pytorch/summaries.npz
0: 2018-09-27 22:56:53,934 INFO Finished training
0: 2018-09-27 22:56:53,934 INFO Train samples 32768 time 40.0993s rate 817.171 samples/s
0: 2018-09-27 22:56:53,934 INFO Valid rate: 2417.14 samples/s
0: 2018-09-27 22:56:53,934 INFO All done!
